<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Creating a Return Package </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Creating a Return Package ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="creating-a-return-package">Creating a Return Package</h1>

<p>After translators/editors have fully processed the files contained in a project package (see <a href="creating_a_project_package.html">Creating a Project Package</a>), they send them back in a so-called return package. Similar to a project package, a return package is technically a ZIP file that have the extension <em>*.sdlrpx</em>. Return packages are usually a lot smaller than project packages, as they contain only the compressed bilingual (SDLXliff) files, i.e. no project TMs, reference files, or any other resources. For this reason, when you create a return package programmatically there are far less options available to configure.</p>
<h2 id="create-a-return-package-programmatically">Create a Return Package Programmatically</h2>
<p>In the sample implementation below we use a function called <code>CreatePackage</code>, which takes a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html">FileBasedProject</a> object as parameter. First, select the files that need to be included in the return package. It is possible that the original project package on which the return package is based contained several target languages, e.g. when the project package was sent to a translator or agency who can handle more than one target language. However, let us assume for the following example that there is only one target language involved, e.g. German (<em>de-DE</em>) and that all files of that target language should be returned. Use the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.globalization.cultureinfo?redirectedfrom=MSDN&amp;view=net-5.0">CultureInfo</a> class to create a new Language object.</p>
<p>Next, apply the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_GetTargetLanguageFiles">GetTargetLanguageFiles</a> method to the project to retrieve the target files for the selected language and to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ProjectFile.html">ProjectFile</a> array. Since the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_GetTargetLanguageFiles">GetTargetLanguageFiles</a> method, which we are going to apply later requires, the file ids as parameter, apply the <code>GetIds</code> method to create a <code>Guid</code> array, which contains the project file ids:</p>
<div class="tabGroup" id="tabgroup_PwERp5rA9-">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_PwERp5rA9-_tabid-1" role="tab" aria-controls="tabpanel_PwERp5rA9-_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_PwERp5rA9-_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">Language targetLang = new Language(CultureInfo.GetCultureInfo(&quot;de-DE&quot;));
ProjectFile[] files = project.GetTargetLanguageFiles(targetLang);
Guid[] fileIds = files.GetIds();
</code></pre></section>
</div>
<p>In the next step, apply the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_GetTargetLanguageFiles">GetTargetLanguageFiles</a> method to the project, thus creating a package object that is based on the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ReturnPackageCreation.html">ReturnPackageCreation</a> class. This method takes the following parameters:</p>
<ul>
<li>The ids of the project files to include in the package</li>
<li>The return package name</li>
<li>An optional comment string, e.g. a note to the project manager if there was a problem during translation that should be looked at</li>
</ul>
<div class="tabGroup" id="tabgroup_PwERp5rA9--1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_PwERp5rA9--1_tabid-2" role="tab" aria-controls="tabpanel_PwERp5rA9--1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_PwERp5rA9--1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">ReturnPackageCreation returnPackage = project.CreateReturnPackage(fileIds, &quot;Return Package Name&quot;, &quot;Comment: Everything went fine&quot;);
</code></pre></section>
</div>
<p>Finally, apply the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_SavePackageAs_System_Guid_System_String_">SavePackageAs</a> method to the project to physically save the actual return package file. This method requires the package id (which you can retrieve from the  <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ReturnPackageCreation.html">ReturnPackageCreation</a> object) and the file name and path as parameters.</p>
<div class="tabGroup" id="tabgroup_PwERp5rA9--2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_PwERp5rA9--2_tabid-3" role="tab" aria-controls="tabpanel_PwERp5rA9--2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_PwERp5rA9--2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">project.SavePackageAs(returnPackage.PackageId, @&quot;c\temp\return_package.sdlrpx&quot;);
</code></pre></section>
</div>
<p>Note that a return package may also contain only some of the files from the original project package. For example, a translator may have to return the first two out of five files earlier, because they have become more urgent. In that case you can programmatically create the package with only some of the target files by specifying the corresponding file ids during project creation.</p>
<h2 id="check-the-return-package-creation-status">Check the Return Package Creation Status</h2>
<p>It may happen that the package creation fails for some reason (e.g. any files to include in the package have accidentally been deleted or have become corrupted). This is why you should check for any events during the project package creation, and output a message to the user if required.</p>
<p>The following sample code leverages the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.PackageStatus.html">PackageStatus</a> class to check the project package status. It throws an error message if in the end the package status is not <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.PackageStatus.html#fields">Completed</a>:</p>
<div class="tabGroup" id="tabgroup_PwERp5rA9--3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_PwERp5rA9--3_tabid-4" role="tab" aria-controls="tabpanel_PwERp5rA9--3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_PwERp5rA9--3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">bool packageIsCreated = false;
while (!packageIsCreated)
{
    switch (returnPackage.Status)
    {
        case PackageStatus.Cancelling:
        case PackageStatus.InProgress:
        case PackageStatus.Scheduled:
        case PackageStatus.NotStarted:
            packageIsCreated = false;
            break;
        case PackageStatus.Cancelled:
        case PackageStatus.Completed:
        case PackageStatus.Failed:
        case PackageStatus.Invalid:
            packageIsCreated = true;
            break;
        default:
            break;
    }
}

if (returnPackage.Status != PackageStatus.Completed)
{
    throw new Exception(&quot;A problem occurred during package creation.&quot;);
}
</code></pre></section>
</div>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<p>The complete function should now look as shown below:</p>
<div class="tabGroup" id="tabgroup_PwERp5rA9--4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_PwERp5rA9--4_tabid-5" role="tab" aria-controls="tabpanel_PwERp5rA9--4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_PwERp5rA9--4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-cs">public void CreatePackage(FileBasedProject project)
{
    #region &quot;FileIds&quot;
    Language targetLang = new Language(CultureInfo.GetCultureInfo(&quot;de-DE&quot;));
    ProjectFile[] files = project.GetTargetLanguageFiles(targetLang);
    Guid[] fileIds = files.GetIds();
    #endregion

    #region &quot;ReturnPackage&quot;
    ReturnPackageCreation returnPackage = project.CreateReturnPackage(fileIds, &quot;Return Package Name&quot;, &quot;Comment: Everything went fine&quot;);
    #endregion

    #region &quot;PackageStatus&quot;
    bool packageIsCreated = false;
    while (!packageIsCreated)
    {
        switch (returnPackage.Status)
        {
            case PackageStatus.Cancelling:
            case PackageStatus.InProgress:
            case PackageStatus.Scheduled:
            case PackageStatus.NotStarted:
                packageIsCreated = false;
                break;
            case PackageStatus.Cancelled:
            case PackageStatus.Completed:
            case PackageStatus.Failed:
            case PackageStatus.Invalid:
                packageIsCreated = true;
                break;
            default:
                break;
        }
    }

    if (returnPackage.Status != PackageStatus.Completed)
    {
        throw new Exception(&quot;A problem occurred during package creation.&quot;);
    }
    #endregion

    #region &quot;SavePackage&quot;
    project.SavePackageAs(returnPackage.PackageId, @&quot;c\temp\return_package.sdlrpx&quot;);
    #endregion
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="creating_a_project_package.html">Creating a Project Package</a></p>
<p><a href="importing_a_return_package.html">Importing a Return Package</a></p>
<p><a href="about_packages.html">About Packages</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/projectautomation/creating_a_return_package.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
