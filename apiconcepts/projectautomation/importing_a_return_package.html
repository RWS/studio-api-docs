<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Importing a Return Package </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Importing a Return Package ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="importing-a-return-package">Importing a Return Package</h1>

<p>After the return package (see <a href="creating_a_return_package.html">Creating a Return Package</a>) has been sent back to the project manager, e.g. via e-mail, he/she opens it in Trados Studio. This basically means that the package content is extracted, and the translated, edited, or proofread bilingual (SDLXliff) document overwrite the previous (e.g. untranslated) files, thus updating the project on the project manager&#39;s side.</p>
<h2 id="import-a-return-package-programmatically">Import a Return Package Programmatically</h2>
<p>Implementing a function called <code>OpenPackage</code>, which takes the project file name (i.e. the name and path of the <em>*.sdlproj</em> file) and the name and path of the return package (i.e. the <em>*.sdlrpx</em> file) as string parameters.</p>
<p>Within the function start by opening the project as shown below:</p>
<div class="tabGroup" id="tabgroup_y5my7dn7WY">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_y5my7dn7WY_tabid-1" role="tab" aria-controls="tabpanel_y5my7dn7WY_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_y5my7dn7WY_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">FileBasedProject project = new FileBasedProject(projectFile);
</code></pre></section>
</div>
<p>To import and extract the return package content into your project, apply the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_ImportReturnPackage_System_String_">ImportReturnPackage</a> method to your project to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ReturnPackageImport.html">ReturnPackageImport</a> object. This method requires the full return package file name and path as parameter, as shown in the example function below:</p>
<div class="tabGroup" id="tabgroup_y5my7dn7WY-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_y5my7dn7WY-1_tabid-2" role="tab" aria-controls="tabpanel_y5my7dn7WY-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_y5my7dn7WY-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">ReturnPackageImport import = project.ImportReturnPackage(returnPackageFile);
</code></pre></section>
</div>
<div class="NOTE"><h5>Note</h5><p>Note that the system &#39;knows&#39; to which project a return package belongs, because the XML manifest file contains the unique project id (guid), which is used to identify the project into which the return package content should be imported. If the return package manifest contains a guid that does not match any of the projects of the system, an error will be thrown.</p>
</div>
<div class="NOTE"><h5>Note</h5><p>After importing a return package, the return package file will be copied into the folder structure of the project. The sub-folder will be called <em>Packages/In</em>. Moreover, the package file name will be marked with the date and time of the import, e.g. <em>return_package-201071-13h39m34s.sdlrpx</em>.</p>
</div>
<div class="NOTE"><h5>Note</h5><p>After importing the return package, the project statistics will usually change, e.g. more segments should now have the translated, reviewed, etc. state. See also <a href="retrieving_the_project_statistics.html">Retrieving the Project Statistics</a>.</p>
</div>
<div class="NOTE"><h5>Note</h5><p>Once a return package has been imported, it cannot be imported again. If you try to re-import the same return package, an exception will be thrown.</p>
</div>
<h2 id="check-the-import-status">Check the Import Status</h2>
<p>It may happen that the return extraction and import fails for some reason (e.g. a project file has accidentally been set to read-only and thus cannot be overwritten and updated by a file in the return package). This is why you should check for the import status, and output a message to the user if required. The following sample code leverages the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.PackageStatus.html">PackageStatus</a> class to check the project package status. It throws an error message if in the end the package status is not <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.PackageStatus.html#fields">Completed</a>:</p>
<div class="tabGroup" id="tabgroup_y5my7dn7WY-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_y5my7dn7WY-2_tabid-3" role="tab" aria-controls="tabpanel_y5my7dn7WY-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_y5my7dn7WY-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">bool packageIsImported = false;
while (!packageIsImported)
{
    switch (import.Status)
    {
        case PackageStatus.Cancelling:
        case PackageStatus.InProgress:
        case PackageStatus.Scheduled:
        case PackageStatus.NotStarted:
            packageIsImported = false;
            break;
        case PackageStatus.Cancelled:
        case PackageStatus.Completed:
        case PackageStatus.Failed:
        case PackageStatus.Invalid:
            packageIsImported = true;
            break;
        default:
            break;
    }
}

if (import.Status != PackageStatus.Completed)
{
    throw new Exception(&quot;A problem occurred during package import.&quot;);
}
</code></pre></section>
</div>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<p>The complete function should now look as shown below:</p>
<div class="tabGroup" id="tabgroup_y5my7dn7WY-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_y5my7dn7WY-3_tabid-4" role="tab" aria-controls="tabpanel_y5my7dn7WY-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_y5my7dn7WY-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">public void OpenPackage(string projectFile, string returnPackageFile)
{
    #region &quot;EventArgs&quot;
    List&lt;TaskStatusEventArgs&gt; taskStatusEventArgsList = new List&lt;TaskStatusEventArgs&gt;();
    List&lt;MessageEventArgs&gt; messageEventArgsList = new List&lt;MessageEventArgs&gt;();
    #endregion

    #region &quot;OpenProject&quot;
    FileBasedProject project = new FileBasedProject(projectFile);
    #endregion

    #region &quot;ImportPackage&quot;
    ReturnPackageImport import = project.ImportReturnPackage(returnPackageFile);
    #endregion

    #region &quot;CheckImportStatus&quot;
    bool packageIsImported = false;
    while (!packageIsImported)
    {
        switch (import.Status)
        {
            case PackageStatus.Cancelling:
            case PackageStatus.InProgress:
            case PackageStatus.Scheduled:
            case PackageStatus.NotStarted:
                packageIsImported = false;
                break;
            case PackageStatus.Cancelled:
            case PackageStatus.Completed:
            case PackageStatus.Failed:
            case PackageStatus.Invalid:
                packageIsImported = true;
                break;
            default:
                break;
        }
    }

    if (import.Status != PackageStatus.Completed)
    {
        throw new Exception(&quot;A problem occurred during package import.&quot;);
    }
    #endregion
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="creating_a_return_package.html">Creating a Return Package</a></p>
<p><a href="about_packages.html">About Packages</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/projectautomation/importing_a_return_package.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
