<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Generating the Task Report </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Generating the Task Report ">
    <meta name="generator" content="docfx 2.58.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="generating-the-task-report">Generating the Task Report</h1>

<p>This chapter explains how to retrieve the actual task result, which is the analyze files report. There are two ways of generating a task report, an easy way, and a &#39;hard&#39; way:</p>
<ul>
<li>You can simply apply apply the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_SaveTaskReportAs_System_Guid_System_String_Sdl_ProjectAutomation_Core_ReportFormat_">SaveTaskReportAs</a> method to a project in order to generate a standard report in any of the following formats: Excel, HTML, MHT, or XML.</li>
<li>You can also retrieve the task statistics bit-by-bit through various properties, e.g. the number of segments, words, and characters that fall into the exact match category. This allows you to generate a custom output, e.g. a custom XML file for importing into an accounting and billing system.</li>
</ul>
<p>In this chapter examples for both approaches will be demonstrated.</p>
<p>Start by implementing a helper function called CreateReports. This function takes a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html">FileBasedProject</a> object and the report file path string as parameters. Note that the reports should be generated in the document main path. Creating a standard report is easy and can basically be done with a single line of code. All you need to do is apply the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_SaveTaskReportAs_System_Guid_System_String_Sdl_ProjectAutomation_Core_ReportFormat_">SaveTaskReportAs</a> method to the project. This method requires the following parameters:</p>
<ul>
<li>The id of the report for which the report should be generated.</li>
<li>The report file and location.</li>
<li>The report format (i.e. Excel, HTML, MHT or XML).</li>
</ul>
<p>Like project files all task reports are uniquely referenced through a guid. In order to be able to track the guid of the analyze report that was automatically generated in the backgrond when performing this task, we declare the following private variable in the class, i.e.:</p>
<div class="tabGroup" id="tabgroup_i8OFZL3epg">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_i8OFZL3epg_tabid-1" role="tab" aria-controls="tabpanel_i8OFZL3epg_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_i8OFZL3epg_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">private Guid reportId;
</code></pre></section>
</div>
<p>Then add the following line to the <code>RunFileAnalysis</code> function (see chapter <a href="analyzing_the_files.html">Analyzing the Files</a>) to set the report id. Note that when executing a task, a report is automatically generated in the background without you having to explicitly generate it programmatically. The report is physically saved as an XML file, which is stored in a <em>Reports</em> sub-folder. The XML file itself is called, for example, <em>Analyze Files en-US_de-DE.xml</em>. We do this by applying the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.AutomaticTask.html#Sdl_ProjectAutomation_Core_AutomaticTask_Reports">Reports</a> property to the analysis task object. Since this task has been executed only once, there is only one report available, therefore we select the id of the first report:</p>
<div class="tabGroup" id="tabgroup_i8OFZL3epg-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_i8OFZL3epg-1_tabid-2" role="tab" aria-controls="tabpanel_i8OFZL3epg-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_i8OFZL3epg-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">this.reportId = analyzeTask.Reports[0].Id;
</code></pre></section>
</div>
<p>Now you can provide all parameters required by the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_SaveTaskReportAs_System_Guid_System_String_Sdl_ProjectAutomation_Core_ReportFormat_">SaveTaskReportAs</a> method. Note that the available report formats can be accessed through the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ReportFormat.html">ReportFormat</a> class:</p>
<div class="tabGroup" id="tabgroup_i8OFZL3epg-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_i8OFZL3epg-2_tabid-3" role="tab" aria-controls="tabpanel_i8OFZL3epg-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_i8OFZL3epg-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">project.SaveTaskReportAs(this.reportId, path + &quot;/AnalyzeTaskReport.xls&quot;, ReportFormat.Excel);
</code></pre></section>
</div>
<h2 id="create-the-custom-report-output">Create the Custom Report Output</h2>
<p>Creating a custom output is a bit more challenging. It requires us to retrieve the segment, word, character, etc. count through various properties and integrate this information in custom format, which in our implementation is a simple console output.</p>
<p>To do this, we need to take three steps. Start by creating an object based on the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ProjectStatistics.html">ProjectStatistics</a> class, which contains the statistical information on the entire project. You create the project statistics object by applying the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_GetProjectStatistics">GetProjectStatistics</a> method to your project. From the project statistics you derive the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ProjectStatistics.html#Sdl_ProjectAutomation_Core_ProjectStatistics_TargetLanguageStatistics">TargetLanguageStatistics</a>, i.e. the statistics for your target language. Note that since a project can have multiple target languages, the target language statistics are represented through an array of <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ProjectStatistics.html#Sdl_ProjectAutomation_Core_ProjectStatistics_TargetLanguageStatistics">TargetLanguageStatistics</a> objects. Since our project only involves one target language, we take the first object in the array to derive from it a <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.AnalysisStatistics.html">AnalysisStatistics</a> object as shown in the code example below. This analysis statistics object acts as a container for the segment, word, etc. count information of the first (and in this implementation only) target language in which the analysis task was performed:</p>
<div class="tabGroup" id="tabgroup_i8OFZL3epg-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_i8OFZL3epg-3_tabid-4" role="tab" aria-controls="tabpanel_i8OFZL3epg-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_i8OFZL3epg-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">ProjectStatistics projectStats = project.GetProjectStatistics();
TargetLanguageStatistics[] targetStats = projectStats.TargetLanguageStatistics;
AnalysisStatistics analysisStats = targetStats[0].AnalysisStatistics;
</code></pre></section>
</div>
<p>Now you can proceed to retrieving the count results for the various match categories, e.g.:</p>
<ul>
<li>Perfect matches</li>
<li>Context matches</li>
<li>Exact matches</li>
<li>Fuzzy matches</li>
<li>Repetitions</li>
<li>New (unknown) segments</li>
<li>The total segment/word/character count</li>
</ul>
<p>For each match categories you can retrieve the number of:</p>
<ul>
<li>Segments</li>
<li>Words</li>
<li>Characters</li>
<li>Tags</li>
<li>Placeables (i.e. elements such as numbers, acronyms, dates.)</li>
</ul>
<p>Below is an example of how to retrieve and output this information for the exact match category:</p>
<div class="tabGroup" id="tabgroup_i8OFZL3epg-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_i8OFZL3epg-4_tabid-5" role="tab" aria-controls="tabpanel_i8OFZL3epg-4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_i8OFZL3epg-4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-cs">result += &quot;\nExact matches\n&quot;;
result += &quot;Segments: &quot; + analysisStats.Exact.Segments.ToString() + &quot;\n&quot;;
result += &quot;Words: &quot; + analysisStats.Exact.Words.ToString() + &quot;\n&quot;;
result += &quot;Characters: &quot; + analysisStats.Exact.Characters.ToString() + &quot;\n&quot;;
result += &quot;Tags: &quot; + analysisStats.Exact.Tags.ToString() + &quot;\n&quot;;
result += &quot;Placeables: &quot; + analysisStats.Exact.Placeables.ToString() + &quot;\n&quot;;
</code></pre></section>
</div>
<p>Outputting the analysis results for the fuzzy matches is somewhat more complex, as the fuzzy category is further subdivided into fuzzy bands. The default fuzzy band are as follows:</p>
<ul>
<li>99%-95%</li>
<li>94%-85%</li>
<li>84%-75%</li>
<li>74%-50%</li>
</ul>
<p>Note that Trados Studio allows you to freely re-define these fuzzy bands, i.e. it is possible to change the range and to increase or decrease the number of fuzzy bands. This is why in the following sample code we loop through the available fuzzy bands and determine the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.AnalysisBand.html#Sdl_ProjectAutomation_Core_AnalysisBand_MaximumMatchValue">MaximumMatchValue</a> and the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Settings.TranslationMemorySettings.html#Sdl_ProjectAutomation_Settings_TranslationMemorySettings_TranslationMinimumMatchValue">TranslationMinimumMatchValue</a>. After determining the fuzzy bands with their minimum and maximum match values we output the corresponding number of segments, words, and characters as shown below:</p>
<div class="tabGroup" id="tabgroup_i8OFZL3epg-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_i8OFZL3epg-5_tabid-6" role="tab" aria-controls="tabpanel_i8OFZL3epg-5_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_i8OFZL3epg-5_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-cs">for (int i = 0; i &lt; analysisStats.Fuzzy.Length; i++)
{
    string rangeMax = analysisStats.Fuzzy[i].Band.MaximumMatchValue.ToString();
    string rangeMin = analysisStats.Fuzzy[i].Band.MinimumMatchValue.ToString();

    result += &quot;\nFuzzy matches &quot; + rangeMax + &quot;% to &quot; + rangeMin + &quot;%\n&quot;;
    result += &quot;Segments: &quot; + analysisStats.Fuzzy[i].Segments.ToString() + &quot;\n&quot;;
    result += &quot;Words: &quot; + analysisStats.Fuzzy[i].Words.ToString() + &quot;\n&quot;;
    result += &quot;Characters: &quot; + analysisStats.Fuzzy[i].Characters.ToString() + &quot;\n&quot;;
    result += &quot;Tags: &quot; + analysisStats.Fuzzy[i].Tags.ToString() + &quot;\n&quot;;
    result += &quot;Placeables: &quot; + analysisStats.Fuzzy[i].Placeables.ToString() + &quot;\n&quot;;
}
</code></pre></section>
</div>
<p>For the full implementation see the section below:</p>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<p>The complete function for creating the reports should look as shown below:</p>
<div class="tabGroup" id="tabgroup_i8OFZL3epg-6">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_i8OFZL3epg-6_tabid-7" role="tab" aria-controls="tabpanel_i8OFZL3epg-6_tabid-7" data-tab="tabid-7" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_i8OFZL3epg-6_tabid-7" role="tabpanel" data-tab="tabid-7">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// Retrieves the results of the analyze files tasks and generates a standard
/// report in Microsoft Excel format as well as a report in a custom XML format.
/// &lt;/summary&gt; 
private void CreateReports(FileBasedProject project, string path)
{
    #region &quot;CreateStandardReport&quot;
    project.SaveTaskReportAs(this.reportId, path + &quot;/AnalyzeTaskReport.xls&quot;, ReportFormat.Excel);
    #endregion

    #region &quot;Statistics&quot;
    ProjectStatistics projectStats = project.GetProjectStatistics();
    TargetLanguageStatistics[] targetStats = projectStats.TargetLanguageStatistics;
    AnalysisStatistics analysisStats = targetStats[0].AnalysisStatistics;
    #endregion

    #region &quot;WriteData&quot;
    string result = &quot;Analysis result for all files:\n\n&quot;;

    result += &quot;\nPerfect matches\n&quot;;
    result += &quot;Segments: &quot; + analysisStats.Perfect.Segments.ToString() + &quot;\n&quot;;
    result += &quot;Words: &quot; + analysisStats.Perfect.Words.ToString() + &quot;\n&quot;;
    result += &quot;Characters: &quot; + analysisStats.Perfect.Characters.ToString() + &quot;\n&quot;;
    result += &quot;Tags: &quot; + analysisStats.Perfect.Tags.ToString() + &quot;\n&quot;;
    result += &quot;Placeables: &quot; + analysisStats.Perfect.Placeables.ToString() + &quot;\n&quot;;

    result += &quot;\nContext matches\n&quot;;
    result += &quot;Segments: &quot; + analysisStats.InContextExact.Segments.ToString() + &quot;\n&quot;;
    result += &quot;Words: &quot; + analysisStats.InContextExact.Words.ToString() + &quot;\n&quot;;
    result += &quot;Characters: &quot; + analysisStats.InContextExact.Characters.ToString() + &quot;\n&quot;;
    result += &quot;Tags: &quot; + analysisStats.InContextExact.Tags.ToString() + &quot;\n&quot;;
    result += &quot;Placeables: &quot; + analysisStats.InContextExact.Placeables.ToString() + &quot;\n&quot;;

    #region &quot;Exact&quot;
    result += &quot;\nExact matches\n&quot;;
    result += &quot;Segments: &quot; + analysisStats.Exact.Segments.ToString() + &quot;\n&quot;;
    result += &quot;Words: &quot; + analysisStats.Exact.Words.ToString() + &quot;\n&quot;;
    result += &quot;Characters: &quot; + analysisStats.Exact.Characters.ToString() + &quot;\n&quot;;
    result += &quot;Tags: &quot; + analysisStats.Exact.Tags.ToString() + &quot;\n&quot;;
    result += &quot;Placeables: &quot; + analysisStats.Exact.Placeables.ToString() + &quot;\n&quot;;
    #endregion

    #region &quot;Fuzzy&quot;
    for (int i = 0; i &lt; analysisStats.Fuzzy.Length; i++)
    {
        string rangeMax = analysisStats.Fuzzy[i].Band.MaximumMatchValue.ToString();
        string rangeMin = analysisStats.Fuzzy[i].Band.MinimumMatchValue.ToString();

        result += &quot;\nFuzzy matches &quot; + rangeMax + &quot;% to &quot; + rangeMin + &quot;%\n&quot;;
        result += &quot;Segments: &quot; + analysisStats.Fuzzy[i].Segments.ToString() + &quot;\n&quot;;
        result += &quot;Words: &quot; + analysisStats.Fuzzy[i].Words.ToString() + &quot;\n&quot;;
        result += &quot;Characters: &quot; + analysisStats.Fuzzy[i].Characters.ToString() + &quot;\n&quot;;
        result += &quot;Tags: &quot; + analysisStats.Fuzzy[i].Tags.ToString() + &quot;\n&quot;;
        result += &quot;Placeables: &quot; + analysisStats.Fuzzy[i].Placeables.ToString() + &quot;\n&quot;;
    }
    #endregion

    result += &quot;\nRepetitions\n&quot;;
    result += &quot;Segments: &quot; + analysisStats.Repetitions.Segments.ToString() + &quot;\n&quot;;
    result += &quot;Words: &quot; + analysisStats.Repetitions.Words.ToString() + &quot;\n&quot;;
    result += &quot;Characters: &quot; + analysisStats.Repetitions.Characters.ToString() + &quot;\n&quot;;
    result += &quot;Tags: &quot; + analysisStats.Repetitions.Tags.ToString() + &quot;\n&quot;;
    result += &quot;Placeables: &quot; + analysisStats.Repetitions.Placeables.ToString() + &quot;\n&quot;;

    result += &quot;\nNew segments\n&quot;;
    result += &quot;Segments: &quot; + analysisStats.New.Segments.ToString() + &quot;\n&quot;;
    result += &quot;Words: &quot; + analysisStats.New.Words.ToString() + &quot;\n&quot;;
    result += &quot;Characters: &quot; + analysisStats.New.Characters.ToString() + &quot;\n&quot;;
    result += &quot;Tags: &quot; + analysisStats.New.Tags.ToString() + &quot;\n&quot;;
    result += &quot;Placeables: &quot; + analysisStats.New.Placeables.ToString() + &quot;\n&quot;;

    result += &quot;\nTotal\n&quot;;
    result += &quot;Segments: &quot; + analysisStats.Total.Segments.ToString() + &quot;\n&quot;;
    result += &quot;Words: &quot; + analysisStats.Total.Words.ToString() + &quot;\n&quot;;
    result += &quot;Characters: &quot; + analysisStats.Total.Characters.ToString() + &quot;\n&quot;;
    result += &quot;Tags: &quot; + analysisStats.Total.Tags.ToString() + &quot;\n&quot;;
    result += &quot;Placeables: &quot; + analysisStats.Total.Placeables.ToString() + &quot;\n&quot;;

    Console.Write(result);

    #endregion
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="retrieving_the_project_statistics.html">Retrieving the Project Statistics</a></p>
<p><a href="saving_task_reports.html">Saving Task Reports</a></p>
<p><a href="about_project_files.html">About Project Files</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/ff69c885132c8aed0638723c17e4f0288c3da052/apiconcepts/projectautomation/generating_the_task_report.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
