<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Adding Files and Folders </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Adding Files and Folders ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="adding-files-and-folders">Adding Files and Folders</h1>

<p>In Trados Studio a project requires at least one translatable file. Translatable files can be, for example, Microsoft Word, PowerPoint, etc. documents. Beyond that, a project can also contain reference files. These are untranslatable (e.g. pictures), which can help translators do their job, as they may contain useful information. In addition to that a project can contain so-called localizable files. Localizable files cannot be processed by Trados Studio. These can gain be, for example, bitmap graphics. However, these files contain localizable content (e.g. text in screenshots), which has to be handled outside of Trados Studio. For this, translators can enter the target strings, for example, in a separate text file (legend), or use a graphics program to handle the localizations. This chapter contains an example of how to add files to a project programmatically, and change the file usage to e.g. localizable.</p>
<h2 id="implement-the-function-for-adding-files">Implement the Function for Adding Files</h2>
<p>To add files to a project, you need to apply the <code>AddFiles</code> method to the project object. This method takes a string array as parameter that contains the names and the full path of the file(s) to add to the project. In our example, we &#39;outsource&#39; the string array to a separate helper function called <code>AddProjectFiles</code>, e.g.:</p>
<div class="tabGroup" id="tabgroup_F+lUYy7U44">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_F+lUYy7U44_tabid-1" role="tab" aria-controls="tabpanel_F+lUYy7U44_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_F+lUYy7U44_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-CS">ProjectFile[] files=newProject.AddFiles(this.AddProjectFiles(@&quot;c:\ProjectFiles\Documents\&quot;));
</code></pre></section>
</div>
<p>The helper function that returns the file name string array looks as shown below:</p>
<div class="tabGroup" id="tabgroup_F+lUYy7U44-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_F+lUYy7U44-1_tabid-2" role="tab" aria-controls="tabpanel_F+lUYy7U44-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_F+lUYy7U44-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-CS">public string[] AddProjectFiles(string path)
{
    string[] projectFiles = 
    { 
        path + &quot;brochure.pdf&quot;, 
        path + &quot;Configuration.doc&quot;,   
        path + &quot;New_Features.ppt&quot;, 
        path + &quot;options.jpg&quot;
    };

    return projectFiles;
}
</code></pre></section>
</div>
<p>The following screenshot illustrates how the source documents to process are added in the <strong>New Project</strong> wizard of Trados Studio:
<img src="images/NewProject03.jpg" alt="NewProject03"></p>
<p>When adding files in Trados Studio, they are automatically scanned in order to determine whether they are translatable or not. If a suitable file type definition is found, the file is assumed to be translatable. For example, Trados Studio offers a file type definition that supports Microsoft Word documents. If you add a <em>.doc file to a project, the scan task will mark it as a translatable document. Since pixel graphics (</em>.jpg) are not supported, such files will be marked as reference, as no file type definition is available for this format, which cannot be processed in Trados Studio. The sample code below demonstrates how the automatic scan task can be programmatically performed on the source files that have just been added to the project. Trados Studio typically scans files immediately after adding them. When applying the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_RunAutomaticTask_System_Guid___System_String_">RunAutomaticTask</a> method to a project, you need to provide the file ids and the id of the task (i.e. <code>Scan</code>) as parameters:</p>
<div class="tabGroup" id="tabgroup_F+lUYy7U44-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_F+lUYy7U44-2_tabid-3" role="tab" aria-controls="tabpanel_F+lUYy7U44-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_F+lUYy7U44-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-CS">AutomaticTask scanFiles = newProject.RunAutomaticTask(
    newProject.GetSourceLanguageFiles().GetIds(),
    AutomaticTaskTemplateIds.Scan);
</code></pre></section>
</div>
<p>Though the scan task makes the determination of whether a file is translatable or not, users can manually change the file usage. Example: A PDF file is added to a project. Trados Studio offers a file type definition for PDF, so it is by default marked as translatable. However, if the project manager does not want this file to be translated, but provides it as pure reference, he/she can change the file type usage to <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.FileRole.html">Reference</a>. Another example: A BMP file is automatically assumed to be a reference file, as there is no file type definition for processing it. However, if the project manager wants the translator to handle the content in the BMP file (e.g. strings shown in a screenshot), he/she can change its file type usage to <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.FileRole.html">Localizable</a>, so that the translator knows that it has to be handled somehow outside of Trados Studio, e.g. in Adobe PhotoShop.
Alternatively to adding single files, you can also add the content of an entire folder by applying the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.IProject.html#Sdl_ProjectAutomation_Core_IProject_AddFolderWithFiles_System_String_System_Boolean_">AddFolderWithFiles</a> method to the project. This method takes the folder to add as parameter. Moreover, through a boolean parameter you can determine whether recursion should be used to add the files from any sub-folders, e.g.:</p>
<div class="tabGroup" id="tabgroup_F+lUYy7U44-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_F+lUYy7U44-3_tabid-4" role="tab" aria-controls="tabpanel_F+lUYy7U44-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_F+lUYy7U44-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-CS">newProject.AddFolderWithFiles(@&quot;c:\temp&quot;, true);
</code></pre></section>
</div>
<h2 id="change-the-file-usage-role">Change the File Usage (Role)</h2>
<p>As mentioned above, Trados Studio allows you to change the file usage manually, for example, if you want to set a * <em>.ppt</em> file (which is automatically recognized as a translatable) to reference, because it is not supposed to be translated, but should only be provided for information purposes. The screenshot below illustrates how this is done in the <strong>New Project</strong> wizard of Trados Studio:</p>
<p><img src="images/FileUsage.jpg" alt="FileUsage"></p>
<p>Suppose you want to change the usage (role) of two files:</p>
<ul>
<li><strong>brochure.pdf</strong> has been identified as a translatable file, however, its usage should be changed to <em>Reference</em>.</li>
<li><strong>options.jpg</strong> has been identified as a reference file, however, since it is a screenshot, it should be marked as <em>Localizable</em>.</li>
</ul>
<p>Implement a dedicated helper function for setting the role of a specific file. This function should be called <code>SetFileRole</code> and should take the following parameters:</p>
<ul>
<li>A <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html">FileBasedProject</a>. object</li>
<li>The name of the file whose role should be changed (string)</li>
<li>The <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.FileRole.html">FileRole</a> value to set</li>
</ul>
<p>For our two sample files the function can be called as shown below:</p>
<div class="tabGroup" id="tabgroup_F+lUYy7U44-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_F+lUYy7U44-4_tabid-6" role="tab" aria-controls="tabpanel_F+lUYy7U44-4_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_F+lUYy7U44-4_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-CS">this.SetFileRole(newProject, &quot;brochure.pdf&quot;, FileRole.Reference);
this.SetFileRole(newProject, &quot;options.jpg&quot;, FileRole.Localizable);
</code></pre></section>
</div>
<p>The function itself applies the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_GetSourceLanguageFiles">GetSourceLanguageFiles</a> method to the project to retrieve all source documents. It then loops through the documents until it finds the file with the specified name, and adapts its role accordingly. Note that each file in a project is uniquely identified by an id (guid). The <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_SetFileRole_System_Guid___Sdl_ProjectAutomation_Core_FileRole_">SetFileRole</a>  method takes a file guid array as parameter. In our implementation we declare a guid array, even if only the role of one file at a time is adapted.</p>
<div class="tabGroup" id="tabgroup_F+lUYy7U44-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_F+lUYy7U44-5_tabid-7" role="tab" aria-controls="tabpanel_F+lUYy7U44-5_tabid-7" data-tab="tabid-7" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_F+lUYy7U44-5_tabid-7" role="tabpanel" data-tab="tabid-7">
<pre><code class="lang-CS">private void SetFileRole(FileBasedProject project, string fileName, FileRole role)
{
    ProjectFile[] files = project.GetSourceLanguageFiles();
    for (int i = 0; i &lt; files.Length; i++)
    {
        if (files[i].Name == fileName.ToLower())
        {
            Guid[] fileId = { files[i].Id };
            project.SetFileRole(fileId, role);
            break;
        }
    }
}
</code></pre></section>
</div>
<p>After adding the source files as outlined above the project folder should now also contain a sub-folder that corresponds to your selected source language, i.e. <em>en-US</em>. It contains the four source documents that you have added, which were copied into that sub-folder.</p>
<p><img src="images/FoldersAfterAddingsFiles.jpg" alt="FoldersAfterAddingsFiles"></p>
<p>If you were to open the programmatically created * <em>.sdlproj</em> file in Trados Studio, and switched to the <strong>Files</strong> view, you would see the documents listed as shown below. Note that in the column <strong>Usage</strong> the last two files are marked as <em>Reference</em> and <em>Localizable</em>, as you changed the role of these two project files:</p>
<p><img src="images/FilesAddedAsReference.jpg" alt="FilesAddedAsReference"></p>
<h2 id="see-also">See Also</h2>
<p><a href="running_tasks_on_project_files.html">Running Tasks on the Project Files</a></p>
<p><a href="automatic_tasks_and_task_settings.html">Automatic Tasks and Task Settings</a></p>
<p><a href="creating_a_merged_file.html">Creating a Merged File</a></p>
<p><a href="updating_project_files.html">Updating Project Files</a></p>
<p><a href="about_project_files.html">About Project Files</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/projectautomation/adding_files_and_folders.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
