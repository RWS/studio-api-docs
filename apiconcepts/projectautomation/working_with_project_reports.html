<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Working with Project Reports </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Working with Project Reports ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="working-with-project-reports">Working with Project Reports</h1>

<p>In Trados Studio, the project files have associated a set of predefined reports. The built-in reports are visible in the Reports Viewer. Trados Studio Reports API allows the 3rd party developers to extend and customize the existing set of reports and display them within an additional Trados Studio Viewer using a custom developed plugin. </p>
<p>This chapter contains an example of how to add reports to a project programmatically, modify and delete the existing reports and render the reports using Trados Studio predefined templates or custom templates.</p>
<h2 id="getting-the-reports-list">Getting the Reports list</h2>
<p>To enumerate the reports associated to a project, you need to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html">ProjectReportsOperation</a> object based on the current project and call <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html#Sdl_ProjectAutomation_FileBased_Reports_Operations_ProjectReportsOperations_GetProjectReports">GetProjectReports</a> method.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V_tabid-1" role="tab" aria-controls="tabpanel_LvupLjVj-V_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-CS">var reports = new ProjectReportsOperations(fileBasedProject).GetProjectReports();
</code></pre></section>
</div>
<p>The method returns a list with report objects.
The report object is used to handle the reports. It contains the report Id, the name, the description, the task template Id, the ISO abbreviation for language, the physical path of the report file, the group, the creation date, the <code>isCustomReport</code> flag specifying if the report is custom defined or built-in. </p>
<h2 id="get-the-report-definition">Get the Report definition</h2>
<p>To get the report definition, you need to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html">ProjectReportsOperation</a> object based on the current project and call <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html#Sdl_ProjectAutomation_FileBased_Reports_Operations_ProjectReportsOperations_GetReportDefinition_System_String_">GetReportDefinition</a> method. This method takes as input parameters the task template Id.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V-1_tabid-2" role="tab" aria-controls="tabpanel_LvupLjVj-V-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-CS">var reportDefinition = new ProjectReportsOperations(fileBasedProject).GetReportDefinition(&quot;Sdl.ProjectApi.AutomaticTasks.Translate&quot;);
</code></pre></section>
</div>
<p>The method returns the report definition object.
The report definition contains the task template id, the report Uri, the assembly and the report data. </p>
<h2 id="adding-a-report">Adding a Report</h2>
<p>To add a report to a project, you need to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html">ProjectReportsOperation</a> object based on the current project and call <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html#Sdl_ProjectAutomation_FileBased_Reports_Operations_ProjectReportsOperations_AddReport_System_String_System_String_System_String_System_String_System_String_">AddReport</a> method. This method takes as input parameters the task template Id, the report name, description language and content.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V-2_tabid-3" role="tab" aria-controls="tabpanel_LvupLjVj-V-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-CS">var addedReport = new ProjectReportsOperations(fileBasedProject)
.AddReport(&quot;Sdl.ProjectApi.AutomaticTasks.Translate&quot;, &quot;Name&quot;, &quot;Description&quot;, &quot;de-De&quot;, &quot;&lt;xml&gt;&lt;/xml&gt;&quot;);
</code></pre></section>
</div>
<p>The method returns the report object.
The method will throw an exception if the task template Id does not exists or the report content is not in xml format.</p>
<h2 id="updating-a-report">Updating a Report</h2>
<p>To update a report to a project, you need to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html">ProjectReportsOperation</a> object based on the current project and call <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html#Sdl_ProjectAutomation_FileBased_Reports_Operations_ProjectReportsOperations_UpdateReport_System_Guid_System_String_System_String_System_String_">UpdateReport</a> method. This method takes as input parameters the task template, the report name, description and content.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V-3_tabid-4" role="tab" aria-controls="tabpanel_LvupLjVj-V-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-CS">new ProjectReportsOperations(fileBasedProject).UpdateReport(&quot;aa84193b-fd88-439c-8293-4ad0f9cfa8ec&quot;, &quot;Name&quot;, &quot;Description&quot;, &quot;&lt;xml&gt;&lt;/xml&gt;&quot;);
</code></pre></section>
</div>
<p>The method will throw an exception if the report Id does not exists or the content is not in xml format.</p>
<h2 id="deleting-reports">Deleting Reports</h2>
<p>To delete one or more reports from a project, you need to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html">ProjectReportsOperation</a> object based on the current project and call <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html#Sdl_ProjectAutomation_FileBased_Reports_Operations_ProjectReportsOperations_RemoveReports_System_Collections_Generic_List_System_Guid__">RemoveReports</a> method. This method takes as input parameters the list with report Ids to be deleted.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V-4_tabid-5" role="tab" aria-controls="tabpanel_LvupLjVj-V-4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V-4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-CS">new ProjectReportsOperations(fileBasedProject).RemoveReports(reports.Select(r =&gt; Guid.Parse(r.Id)).ToList());
</code></pre></section>
</div>
<h2 id="get-the-report-rendering-supported-file-formats">Get the Report Rendering Supported File Formats</h2>
<p>To get the supported file formats for rendering a report, you need to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html">ProjectReportsOperation</a> object based on the current project and call <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html#Sdl_ProjectAutomation_FileBased_Reports_Operations_ProjectReportsOperations_GetReportRenderingSupportedFileFormats_System_Guid_">GetReportRenderingSupportedFileFormats</a> method. This method takes as input parameter the report Id.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V-5_tabid-6" role="tab" aria-controls="tabpanel_LvupLjVj-V-5_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V-5_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-CS">var reportDefinition = new ProjectReportsOperations(fileBasedProject).GetReportRenderingSupportedFileFormats(&quot;aa84193b-fd88-439c-8293-4ad0f9cfa8ec&quot;);
</code></pre></section>
</div>
<p>The method returns a list with file extensions supported by the rendering engine, such as “xml”, “html”.
The method will throw an exception if the task template Id does not exists.</p>
<h2 id="get-the-report-rendering">Get the Report Rendering</h2>
<p>To render a report, you need to create a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html">ProjectReportsOperation</a> object based on the current project and call one of the 2 <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.Reports.Operations.ProjectReportsOperations.html#Sdl_ProjectAutomation_FileBased_Reports_Operations_ProjectReportsOperations_GetReportRendering_System_Guid_System_String_">GetReportRendering</a> overloaded methods. 
The first method takes as input parameters the report Id and the output file format.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V-6">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V-6_tabid-7" role="tab" aria-controls="tabpanel_LvupLjVj-V-6_tabid-7" data-tab="tabid-7" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V-6_tabid-7" role="tabpanel" data-tab="tabid-7">
<pre><code class="lang-CS">var reportDefinition = new ProjectReportsOperations(fileBasedProject).GetReportRendering(&quot;aa84193b-fd88-439c-8293-4ad0f9cfa8ec&quot;, &quot;html&quot;);
</code></pre></section>
</div>
<p>The method returns a byte array with the report content in the specified format.
The method will throw an exception if the report Id does not exists or the output format is not supported.</p>
<p>The second method takes as input parameters the report Id, the path to the custom template and the output file format.</p>
<div class="tabGroup" id="tabgroup_LvupLjVj-V-7">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_LvupLjVj-V-7_tabid-8" role="tab" aria-controls="tabpanel_LvupLjVj-V-7_tabid-8" data-tab="tabid-8" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_LvupLjVj-V-7_tabid-8" role="tabpanel" data-tab="tabid-8">
<pre><code class="lang-CS">var reportDefinition = new ProjectReportsOperations(fileBasedProject).GetReportRendering(&quot;aa84193b-fd88-439c-8293-4ad0f9cfa8ec&quot;, &quot;C:\ReportTemplates\CustomTemplate.xsl&quot;, &quot;html&quot;);
</code></pre></section>
</div>
<p>The method returns a byte array with the report content transformed in the specified format using the custom template.
The method will throw an exception if the report Id does not exists or the output format is not supported.</p>
<p>A Trados Studio pluggin sample using the Reports API is available for download <a href="https://github.com/RWS/Sdl-Community/tree/master/Reports.Viewer.API.Example">here</a>.</p>
<h2 id="see-also">See Also</h2>
<p><a href="https://github.com/RWS/Sdl-Community/tree/master/Reports.Viewer.API.Example">Reports Viewer API Example</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/projectautomation/working_with_project_reports.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
