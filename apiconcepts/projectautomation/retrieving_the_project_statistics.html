<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Retrieving the Project Statistics </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Retrieving the Project Statistics ">
    <meta name="generator" content="docfx 2.58.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="retrieving-the-project-statistics">Retrieving the Project Statistics</h1>

<p>During a project lifecycle the segments contained in the project files typically go through a set of states:</p>
<ul>
<li>Not Translated</li>
<li>Draft</li>
<li>Translated</li>
<li>Reviewed</li>
<li>Translation rejected</li>
<li>Signed-off</li>
<li>Sign-off rejected</li>
<li>The total number of translated and untranslated segments is used to compute the statistics for the project. That way project managers can ascertain the project status at a glance. Using the number of translated and untranslated words project managers can quickly give an estimate of whether the project is on track or not.</li>
</ul>
<h2 id="retrieve-the-project-statistics-programmatically">Retrieve the Project Statistics Programmatically</h2>
<p>Below you see an example of how Trados Studio uses bar charts to visualize the project statistics:</p>
<p><img src="images/Statistics.jpg" alt="Statistics"></p>
<p>Below you will find an example of how to retrieve basic statistical information on a project. Start by implementing a helper function called <code>GetProjectStatistics</code>, which takes a <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html">FileBasedProject</a> object as parameter. In order to retrieve the project statistics, apply the <a href="../../api/projectautomation/Sdl.ProjectAutomation.FileBased.FileBasedProject.html#Sdl_ProjectAutomation_FileBased_FileBasedProject_GetProjectStatistics">GetProjectStatistics</a> method to the project:</p>
<div class="tabGroup" id="tabgroup_YSZ-EVdse5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_YSZ-EVdse5_tabid-1" role="tab" aria-controls="tabpanel_YSZ-EVdse5_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_YSZ-EVdse5_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">public void GetProjectStatistics(FileBasedProject project)
{
    #region &quot;GetProjectStatistics&quot;
    ProjectStatistics projStats = project.GetProjectStatistics();
    #endregion

    #region &quot;TargetLanguageStatistics&quot;
    TargetLanguageStatistics[] targetStats = projStats.TargetLanguageStatistics;
    #endregion

    #region &quot;trgInfo&quot;
    StringBuilder trgInfo = new StringBuilder();
    for (int i = 0; i &lt; targetStats.Length; i++)
    {
        ConfirmationStatistics confirmationStats = targetStats[i].ConfirmationStatistics;

        Language trgLang = new Language(CultureInfo.GetCultureInfo(&quot;de-DE&quot;));
        Guid[] ids = project.GetTargetLanguageFiles(trgLang).GetIds();
        project.RunAutomaticTask(ids, AutomaticTaskTemplateIds.TranslationCount);

        trgInfo.Append(&quot;\nConfirmation statistics for: &quot; + targetStats[i].TargetLanguage.DisplayName + &quot;\n&quot;);
        trgInfo.Append(&quot;Total word count: &quot; + confirmationStats.Total.Words.ToString() + &quot;\n&quot;);
        trgInfo.Append(&quot;Words with untranslated status: &quot; + confirmationStats[ConfirmationLevel.Unspecified].Words.ToString() + &quot;\n&quot;);
        trgInfo.Append(&quot;Words with draft status: &quot; + confirmationStats[ConfirmationLevel.Draft].Words.ToString() + &quot;\n&quot;);
        trgInfo.Append(&quot;Words with translated status: &quot; + confirmationStats[ConfirmationLevel.Translated].Words.ToString() + &quot;\n&quot;);
    }

    MessageBox.Show(trgInfo.ToString());
    #endregion
}
</code></pre></section>
</div>
<p>By doing so, you can retrieve the statistics for the whole project. Usually, you will be interested in the statistics for particular target languages in order to asertain the progress for a specific target language, i.e. you will want to find out the percentage of words already processed e.g. through pre-translation or interactive translation by human translators. The first step is to use the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.TargetLanguageStatistics.html">TargetLanguageStatistics</a> class to derive a target language statistics object from the project statistics as shown below:</p>
<div class="tabGroup" id="tabgroup_YSZ-EVdse5-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_YSZ-EVdse5-1_tabid-2" role="tab" aria-controls="tabpanel_YSZ-EVdse5-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_YSZ-EVdse5-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">TargetLanguageStatistics[] targetStats = projStats.TargetLanguageStatistics;
</code></pre></section>
</div>
<p>Note that since we assume that our sample project has multiple target languages, we create an array of target language statistics objects.
In the next step we loop through the target language statistics objects and compile a string that outputs the total number of words as well as the percentage completed for each target language. Within the loop we derive a <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.ConfirmationStatistics.html">ConfirmationStatistics</a> object for each target language. This object holds, among other things, the total number of words that are in e.g. the untranslated, draft, translated, etc. state for the respective target language. You can specify the state for which you want to retrieve the word or segment count through the <a href="../../api/projectautomation/Sdl.ProjectAutomation.Core.CombinedConfirmationLevel.html">CombinedConfirmationLevel</a> class. The example below retrieves the following information:</p>
<ul>
<li>The total word count per state.</li>
<li>The number of words in untranslated (unspecified) state.</li>
<li>The number of words in draft state. Draft segments are usually created during execution of the pre-translate task if a fuzzy match has been found and is inserted into the document.</li>
<li>The number of words in translated status. During pre-translation exact and context matches are usually inserted as translated (confirmed) segments.</li>
</ul>
<p>The information on all other states (e.g. reviewed, signed-off) can be retrieved in the same way.</p>
<div class="tabGroup" id="tabgroup_YSZ-EVdse5-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_YSZ-EVdse5-2_tabid-3" role="tab" aria-controls="tabpanel_YSZ-EVdse5-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_YSZ-EVdse5-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">StringBuilder trgInfo = new StringBuilder();
for (int i = 0; i &lt; targetStats.Length; i++)
{
    ConfirmationStatistics confirmationStats = targetStats[i].ConfirmationStatistics;

    Language trgLang = new Language(CultureInfo.GetCultureInfo(&quot;de-DE&quot;));
    Guid[] ids = project.GetTargetLanguageFiles(trgLang).GetIds();
    project.RunAutomaticTask(ids, AutomaticTaskTemplateIds.TranslationCount);

    trgInfo.Append(&quot;\nConfirmation statistics for: &quot; + targetStats[i].TargetLanguage.DisplayName + &quot;\n&quot;);
    trgInfo.Append(&quot;Total word count: &quot; + confirmationStats.Total.Words.ToString() + &quot;\n&quot;);
    trgInfo.Append(&quot;Words with untranslated status: &quot; + confirmationStats[ConfirmationLevel.Unspecified].Words.ToString() + &quot;\n&quot;);
    trgInfo.Append(&quot;Words with draft status: &quot; + confirmationStats[ConfirmationLevel.Draft].Words.ToString() + &quot;\n&quot;);
    trgInfo.Append(&quot;Words with translated status: &quot; + confirmationStats[ConfirmationLevel.Translated].Words.ToString() + &quot;\n&quot;);
}

MessageBox.Show(trgInfo.ToString());
</code></pre></section>
</div>
<p>The above is just an example of what kind of statistical information you can retrieve for a project and its target languages. Another example, which shows how to retrieve detailed analysis information can be found in the chapters <a href="generating_the_task_report.html">Generating the Task Report</a>.</p>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<p>The complete function should now look as shown below:</p>
<div class="tabGroup" id="tabgroup_YSZ-EVdse5-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_YSZ-EVdse5-3_tabid-4" role="tab" aria-controls="tabpanel_YSZ-EVdse5-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_YSZ-EVdse5-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">public void GetProjectStatistics(FileBasedProject project)
{
    #region &quot;GetProjectStatistics&quot;
    ProjectStatistics projStats = project.GetProjectStatistics();
    #endregion

    #region &quot;TargetLanguageStatistics&quot;
    TargetLanguageStatistics[] targetStats = projStats.TargetLanguageStatistics;
    #endregion

    #region &quot;trgInfo&quot;
    StringBuilder trgInfo = new StringBuilder();
    for (int i = 0; i &lt; targetStats.Length; i++)
    {
        ConfirmationStatistics confirmationStats = targetStats[i].ConfirmationStatistics;

        Language trgLang = new Language(CultureInfo.GetCultureInfo(&quot;de-DE&quot;));
        Guid[] ids = project.GetTargetLanguageFiles(trgLang).GetIds();
        project.RunAutomaticTask(ids, AutomaticTaskTemplateIds.TranslationCount);

        trgInfo.Append(&quot;\nConfirmation statistics for: &quot; + targetStats[i].TargetLanguage.DisplayName + &quot;\n&quot;);
        trgInfo.Append(&quot;Total word count: &quot; + confirmationStats.Total.Words.ToString() + &quot;\n&quot;);
        trgInfo.Append(&quot;Words with untranslated status: &quot; + confirmationStats[ConfirmationLevel.Unspecified].Words.ToString() + &quot;\n&quot;);
        trgInfo.Append(&quot;Words with draft status: &quot; + confirmationStats[ConfirmationLevel.Draft].Words.ToString() + &quot;\n&quot;);
        trgInfo.Append(&quot;Words with translated status: &quot; + confirmationStats[ConfirmationLevel.Translated].Words.ToString() + &quot;\n&quot;);
    }

    MessageBox.Show(trgInfo.ToString());
    #endregion
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="generating_the_task_report.html">Generating the Task Report</a></p>
<p><a href="about_project_files.html">About Project Files</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/projectautomation/retrieving_the_project_statistics.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
