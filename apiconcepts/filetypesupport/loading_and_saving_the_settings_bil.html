<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Loading and Saving the Settings </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Loading and Saving the Settings ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="loading-and-saving-the-settings">Loading and Saving the Settings</h1>

<p>In this chapter we will learn how to implement the class that is actually responsible for physically storing the settings and for loading the plug-in settings into the plug-in UI. The physical storing occurs in an <em>*.sdlproj</em> or in an <em>*.sdltpl</em> file, which are both XML compliant.</p>
<p><em>*.sdlproj</em> files are automatically created for each document that is opened for translation/editing in Trados Studio or for each project that is created in the application. These files contain project-specific information such as the translation memories/termbases used for a project as well as any project-specific settings, which can also include plug-in settings. An <em>*.sdltpl</em> file is a project template, which users can create to streamline project creation.</p>
<p>The settings bundle stored in an <em>*.sdlproj</em> file as used by our implementation would look, for example, as shown below:</p>
<div class="tabGroup" id="tabgroup_jINcnut673">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673_tabid-1" role="tab" aria-controls="tabpanel_jINcnut673_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">Xml</a>
</li>
</ul>
<section id="tabpanel_jINcnut673_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-xml">&lt;SettingsGroup Id=&quot;Word 2007 v 2.0.0.0&quot;&gt;
      &lt;Setting Id=&quot;Enable&quot;&gt;True&lt;/Setting&gt;
    &lt;/SettingsGroup&gt;
</code></pre></section>
</div>
<p>Click or drag to resize
Loading and Saving the Settings
In this chapter we will learn how to implement the class that is actually responsible for physically storing the settings and for loading the plug-in settings into the plug-in UI. The physical storing occurs in an *.sdlproj or in an *.sdltpl file, which are both XML compliant.</p>
<p>*.sdlproj files are automatically created for each document that is opened for translation/editing in Trados Studio or for each project that is created in the application. These files contain project-specific information such as the translation memories/termbases used for a project as well as any project-specific settings, which can also include plug-in settings. An *.sdltpl file is a project template, which users can create to streamline project creation.</p>
<p>The settings bundle stored in an *.sdlproj file as used by our implementation would look, for example, as shown below:</p>
<div class="tabGroup" id="tabgroup_jINcnut673-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-1_tabid-2" role="tab" aria-controls="tabpanel_jINcnut673-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">Xml</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-xml">&lt;SettingsGroup Id=&quot;Word 2007 v 2.0.0.0&quot;&gt;
      &lt;Setting Id=&quot;Enable&quot;&gt;True&lt;/Setting&gt;
    &lt;/SettingsGroup&gt;
</code></pre></section>
</div>
<p>Each <strong>Setting</strong> element contains an <strong>Id</strong> attribute that denotes the setting (property) name. The <strong>Setting</strong> element encloses the property value, which is changed when the user changes the settings in the UI.</p>
<h2 id="add-the-verifiersettings-class">Add the VerifierSettings Class</h2>
<p>Start by adding a new class to your project called <code>VerifierSettings</code>. Make sure that your class uses the following namespaces:</p>
<ul>
<li><strong>Sdl.Core.Settings</strong></li>
<li><strong>Sdl.FileTypeSupport.Framework.Core.Settings</strong></li>
</ul>
<p>Moreover, the component needs to be derived from the <code>FileTypeSettingsBase</code> class, which provides the methods required for storing and saving settings to the bundle.</p>
<h2 id="implement-the-setting-properties">Implement the Setting Properties</h2>
<p>In this step, add the property that represents our plug-in setting, in this case the boolean property <code>CheckWordArt</code>, which determines whether the verification functionality should be active or not. The <code>MaxWordCount</code> property is used to set or retrieve the maximum number of words a particular segment is allowed to have.</p>
<div class="tabGroup" id="tabgroup_jINcnut673-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-2_tabid-3" role="tab" aria-controls="tabpanel_jINcnut673-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">bool _checkWordArt;
int _maxWordCount;

public bool CheckWordArt
{
    get { return _checkWordArt; }
    set
    {
        _checkWordArt = value;
        OnPropertyChanged(&quot;CheckWordArt&quot;);
    }
}

public int MaxWordCount
{
    get { return _maxWordCount; }
    set
    {
        _maxWordCount = value;
        OnPropertyChanged(&quot;MaxWordCount&quot;);
    }
}
</code></pre></section>
</div>
<h2 id="implement-the-constructor-method">Implement the Constructor Method</h2>
<p>The <code>ResetToDefaults</code> method is provided by the base class. In our implementation, it is just overridden to set the <code>MaxWordCount</code> and <code>CheckWordArtproperties</code> to their default values, i.e. 3 and True:</p>
<div class="tabGroup" id="tabgroup_jINcnut673-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-3_tabid-4" role="tab" aria-controls="tabpanel_jINcnut673-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">public override void ResetToDefaults()
{
    CheckWordArt = true;
    MaxWordCount = 3;
}
</code></pre></section>
</div>
<h2 id="reset-to-defaults">Reset to Defaults</h2>
<p>Next, implement the constructor method. In this implementation, the constructor just calls on the <code>ResetToDefaults</code> of the class to set the <code>CheckWordArt</code> property to its default value, which is True, and 3 as the maximum word count:</p>
<div class="tabGroup" id="tabgroup_jINcnut673-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-4_tabid-5" role="tab" aria-controls="tabpanel_jINcnut673-4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-cs">public VerifierSettings()
{
    ResetToDefaults();
}
</code></pre></section>
</div>
<h2 id="set-the-properties-to-the-values-from-the-settings-bundle">Set the Properties to the Values from the Settings Bundle</h2>
<p>The base class provides the <code>PopulateFromSettingsBundle</code> method to retrieve the current setting from the bundle in the <em>*.sdlproj</em> file and set the <code>CheckWordArt</code> and the <code>MaxWordCount</code> properties of our implementation accordingly.</p>
<p>In the <em>*.sdlproj</em> or <em>*.sdltpl</em> file a settings bundle can look, for example, as shown below:</p>
<div class="tabGroup" id="tabgroup_jINcnut673-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-5_tabid-6" role="tab" aria-controls="tabpanel_jINcnut673-5_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">Xml</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-5_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-xml">&lt;SettingsBundle Guid=&quot;e0873e01-9da4-4e37-80e5-a35fc844f03d&quot;&gt;

   &lt;SettingsGroup Id=&quot;Word 2007 v 2.0.0.0&quot;&gt;
     &lt;Setting Id=&quot;MaxWordCount&quot;&gt;3&lt;/Setting&gt;
     &lt;Setting Id=&quot;CheckWordArt&quot;&gt;True&lt;/Setting&gt;
   &lt;/SettingsGroup&gt;

   &lt;SettingsGroup Id=&quot;TermVerifierSettings&quot;&gt;
     &lt;Setting Id=&quot;Enabled&quot;&gt;True&lt;/Setting&gt;
   &lt;/SettingsGroup&gt;

 &lt;/SettingsBundle&gt;
</code></pre></section>
</div>
<p>A <strong>SettingsBundle</strong> element can enclose a number of <strong>SettingsGroup</strong> nodes. Each settings bundle has a unique id (guid) that is stored in an attribute. The settings bundles are identified by the id of the plug-in that they refer to. A settings group can enclose, for example, file type settings, verification plug-in settings, etc. In the above example the settings bundle encloses one settings group for the term verifier plug-in and another settings group for our sample WordArt verifier plug-in. This id is retrieved from the File Type Component Builder (see <a href="create_new_file_type_component_builder.html">Create a New File Type Component Builder</a>).</p>
<p>This XML structure is also reflected in the API. Within the <code>SaveToSettingsBundle</code> method we create a settings group object based on <code>ISettingsGroup</code> by applying the <code>GetSettingsGroup</code> method to the settings bundle. This method takes the settings bundle id (e.g. <em>Word 2007 v 2.0.0.0</em>) as string parameter. We then use the <code>GetSettingFromSettingsGroup</code> method to set the <code>CheckWordArt</code> and the <code>MaxWordCount</code> properties. This method requires the settings group object, the name of the setting (e.g. <em>CheckWordArt</em>), and the default value as parameters.</p>
<div class="tabGroup" id="tabgroup_jINcnut673-6">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-6_tabid-7" role="tab" aria-controls="tabpanel_jINcnut673-6_tabid-7" data-tab="tabid-7" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-6_tabid-7" role="tabpanel" data-tab="tabid-7">
<pre><code class="lang-cs">public override void PopulateFromSettingsBundle(ISettingsBundle settingsBundle, string configurationId)
{
    ISettingsGroup settingsGroup = settingsBundle.GetSettingsGroup(configurationId);
    ResetToDefaults();
    CheckWordArt = GetSettingFromSettingsGroup(settingsGroup, &quot;CheckWordArt&quot;, CheckWordArt);
    MaxWordCount = GetSettingFromSettingsGroup(settingsGroup, &quot;MaxWordCount&quot;, MaxWordCount);
}
</code></pre></section>
</div>
<h2 id="set-the-properties-to-the-values-from-the-settings-bundle-1">Set the Properties to the Values from the Settings Bundle</h2>
<p>The base class also provides the <code>SaveToSettingsBundle</code> method, which is required to physically store the value of the two properties in the bundle of the *.sdlproj file.</p>
<p>Here too, we create a settings group object based on <code>ISettingsGroup</code> by applying the <code>GetSettingsGroup</code> method to the settings bundle.</p>
<p>Then we use the <code>UpdateSettingInSettingsGroup</code> method to save the settings into the physical representation. This method takes the settings group object, the setting name (string), the setting value, and the default value as parameters.</p>
<div class="tabGroup" id="tabgroup_jINcnut673-7">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-7_tabid-8" role="tab" aria-controls="tabpanel_jINcnut673-7_tabid-8" data-tab="tabid-8" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-7_tabid-8" role="tabpanel" data-tab="tabid-8">
<pre><code class="lang-cs">public override void SaveToSettingsBundle(ISettingsBundle settingsBundle, string configurationId)
{
    ISettingsGroup settingsGroup = settingsBundle.GetSettingsGroup(configurationId);
    var defaults = new VerifierSettings();
    UpdateSettingInSettingsGroup(settingsGroup, &quot;CheckWordArt&quot;, CheckWordArt, defaults.CheckWordArt);
    UpdateSettingInSettingsGroup(settingsGroup, &quot;MaxWordCount&quot;, MaxWordCount, defaults.MaxWordCount);
}
</code></pre></section>
</div>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<p>The complete class should now look as shown below:</p>
<div class="tabGroup" id="tabgroup_jINcnut673-8">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_jINcnut673-8_tabid-9" role="tab" aria-controls="tabpanel_jINcnut673-8_tabid-9" data-tab="tabid-9" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_jINcnut673-8_tabid-9" role="tabpanel" data-tab="tabid-9">
<pre><code class="lang-cs">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Sdl.Core.Settings;
using Sdl.FileTypeSupport.Framework.Core.Settings;
using System.Windows.Forms;

namespace Sdk.FileTypeSupport.Samples.WordArtVerifier
{
    /// &lt;summary&gt;
    /// This class is used to actually store the settings to the settings bundle, which
    /// is physically saved in an *.sdlproj or in an *.sdltpl file.
    /// &lt;/summary&gt;
    public class VerifierSettings: FileTypeSettingsBase
    {
        #region &quot;Properties&quot;
        bool _checkWordArt;
        int _maxWordCount;

        public bool CheckWordArt
        {
            get { return _checkWordArt; }
            set
            {
                _checkWordArt = value;
                OnPropertyChanged(&quot;CheckWordArt&quot;);
            }
        }

        public int MaxWordCount
        {
            get { return _maxWordCount; }
            set
            {
                _maxWordCount = value;
                OnPropertyChanged(&quot;MaxWordCount&quot;);
            }
        }
        #endregion


        #region &quot;Constructor&quot;
        public VerifierSettings()
        {
            ResetToDefaults();
        }
        #endregion    

        #region &quot;OverrideMethods&quot;

        /// &lt;summary&gt;
        /// Define the default value, which is Enabled (i.e. true), as the verification function should
        /// be active by default, and 3 for the default maximum word count.
        /// &lt;/summary&gt;
        #region &quot;ResetToDefaults&quot;
        public override void ResetToDefaults()
        {
            CheckWordArt = true;
            MaxWordCount = 3;
        }
        #endregion


        /// &lt;summary&gt;
        /// This method is used to load the setting from the settings bundle,
        /// which is physically stored in an XML-compliant *.sdlproj or *.sdltpl file.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;settingsBundle&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;configurationId&quot;&gt;&lt;/param&gt;
        #region &quot;PopulateFromSettingsBundle&quot;
        public override void PopulateFromSettingsBundle(ISettingsBundle settingsBundle, string configurationId)
        {
            ISettingsGroup settingsGroup = settingsBundle.GetSettingsGroup(configurationId);
            ResetToDefaults();
            CheckWordArt = GetSettingFromSettingsGroup(settingsGroup, &quot;CheckWordArt&quot;, CheckWordArt);
            MaxWordCount = GetSettingFromSettingsGroup(settingsGroup, &quot;MaxWordCount&quot;, MaxWordCount);
        }
        #endregion


        /// &lt;summary&gt;
        /// This method is used to store the settings as configured in the plug-in UI
        /// in the settings bundle, which means that the settings are physically written
        /// into the XML-compliant *.sdlproj or *.sdltpl file.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;settingsBundle&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;configurationId&quot;&gt;&lt;/param&gt;
        #region &quot;SaveToSettingsBundle&quot;
        public override void SaveToSettingsBundle(ISettingsBundle settingsBundle, string configurationId)
        {
            ISettingsGroup settingsGroup = settingsBundle.GetSettingsGroup(configurationId);
            var defaults = new VerifierSettings();
            UpdateSettingInSettingsGroup(settingsGroup, &quot;CheckWordArt&quot;, CheckWordArt, defaults.CheckWordArt);
            UpdateSettingInSettingsGroup(settingsGroup, &quot;MaxWordCount&quot;, MaxWordCount, defaults.MaxWordCount);
        }
        #endregion

        #endregion
    }
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="implement_the_user_interface_bil.html">Implement the User Interface</a></p>
<p><a href="implement_the_ui_controller_class_bil.html">Implement the UI Controller Class</a></p>
<p><a href="implement_the_verification_logic_bil.html">Implement the Verification Logic</a></p>
<div class="NOTE"><h5>Note</h5><p>This content may be out-of-date. To check the latest information on this topic, inspect the libraries using the Visual Studio Object Browser.</p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/filetypesupport/loading_and_saving_the_settings_bil.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
