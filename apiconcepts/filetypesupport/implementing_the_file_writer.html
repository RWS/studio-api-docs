<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Implementing the File Writer </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Implementing the File Writer ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="implementing-the-file-writer">Implementing the File Writer</h1>

<p>In this chapter you will learn how to implement the component used for generating the target-language file in its native format.</p>
<h2 id="add-a-file-writer-class">Add a File Writer Class</h2>
<p>While the file parser component (see <a href="implementing_the_file_parser.html">Implementing the File Parser</a> is used to convert the native source file into a bilingual intermediary (SDLXliff) format, the file writer does the exact opposite, i.e. it generates the target file in its native format. This is what happens when the user, for example, saves the current file as target or finalizes a project.</p>
<p>Start by adding a <strong>SimpleTextWriter.cs</strong> class to your project. The skeleton writer class looks very similar to the file parser class. Here too, you must reference the namespace <code>System.IO</code>, as you need you can generate a target output file. Then add the namespace <code>Sdl.FileTypeSupport.Framework.NativeApi</code>.</p>
<p>Your writer class needs be derived from <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.NativeApi.AbstractNativeFileWriter.html">AbstractNativeFileWriter</a> and must implement the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.NativeApi.INativeContentCycleAware.html">INativeContentCycleAware</a> interface. The writer class implements the same members as the parser class. Therefore, the minimum amount of code required to build a file type plug-in with a file writer looks as shown below:</p>
<div class="tabGroup" id="tabgroup_yJpNTehyh1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_yJpNTehyh1_tabid-1" role="tab" aria-controls="tabpanel_yJpNTehyh1_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_yJpNTehyh1_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">using System.IO;
using Sdl.FileTypeSupport.Framework.BilingualApi;
using Sdl.FileTypeSupport.Framework.NativeApi;

namespace Sdk.Snippets.Native
{
    class SimpleTextWriter : AbstractNativeFileWriter, INativeContentCycleAware
    {
        IPersistentFileConversionProperties _conversionProperties;
        StreamWriter _targetFile = null;

        public void SetFileProperties(IFileProperties properties)
        {
            _conversionProperties = properties.FileConversionProperties;
        }

        public void EndOfInput()
        {

        }

        public void StartOfInput()
        {

        }
    }
}
</code></pre></section>
</div>
<p>Remember, if you have writer specific settings, you also need to implement the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.IntegrationApi.ISettingsAware.html#Sdl_FileTypeSupport_Framework_IntegrationApi_ISettingsAware_InitializeSettings_Sdl_Core_Settings_ISettingsBundle_System_String_">InitializeSettings</a> method of the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.IntegrationApi.ISettingsAware.html">ISettingsAware</a> interface.</p>
<h2 id="create-the-output-text-file">Create the Output Text File</h2>
<p>First, use the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.NativeApi.INativeContentCycleAware.html#Sdl_FileTypeSupport_Framework_NativeApi_INativeContentCycleAware_StartOfInput">StartOfInput</a> member to apply the logic that creates the native output text file:</p>
<div class="tabGroup" id="tabgroup_yJpNTehyh1-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_yJpNTehyh1-1_tabid-2" role="tab" aria-controls="tabpanel_yJpNTehyh1-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_yJpNTehyh1-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">// create the output text file
public void StartOfInput()
{
    _targetFile = new StreamWriter(OutputProperties.OutputFilePath);
}
</code></pre></section>
</div>
<h1 id="output-text-and-tags">Output Text and Tags</h1>
<p>The text writer basically traverses the intermediary (SDLXliff) file and outputs the elements it encounters (e.g. text and inline tags) to the target output file. Override the methods provided by the abstract file writer class (<a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.NativeApi.AbstractNativeFileWriter.html">AbstractNativeFileWriter</a>) to output these elements. The methods shown below output translatable text, structure tags, and inline start/end tags.</p>
<p>Through the method <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.NativeApi.AbstractNativeFileWriter.html#Sdl_FileTypeSupport_Framework_NativeApi_AbstractNativeFileWriter_SegmentEnd">SegmentEnd</a> you determine what should be done after you have written a segment to the native output file. Our simple text format just requires a line break after each segment, which we output using <code>WriteLine()</code>.</p>
<div class="tabGroup" id="tabgroup_yJpNTehyh1-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_yJpNTehyh1-2_tabid-3" role="tab" aria-controls="tabpanel_yJpNTehyh1-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_yJpNTehyh1-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">// iterate through the bilingual file
// and add translatable text content and the content of
// any structure and inline tags to the target output file
public override void StructureTag(IStructureTagProperties tagInfo)
{
    _targetFile.WriteLine(tagInfo.TagContent);
}

public override void Text(ITextProperties textInfo)
{
    _targetFile.Write(textInfo.Text);
}


public override void InlineStartTag(IStartTagProperties tagInfo)
{
    _targetFile.Write(tagInfo.TagContent);
}

public override void InlineEndTag(IEndTagProperties tagInfo)
{
    _targetFile.Write(tagInfo.TagContent);
}

// make sure a line break is inserted after each end of a segment
public override void SegmentEnd()
{
    _targetFile.WriteLine();
}
</code></pre></section>
</div>
<p>At the end we close the output file object and dispose of it in the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.NativeApi.INativeContentCycleAware.html#Sdl_FileTypeSupport_Framework_NativeApi_INativeContentCycleAware_EndOfInput">EndOfInput</a> member of the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.NativeApi.INativeContentCycleAware.html">INativeContentCycleAware</a> interface:</p>
<div class="tabGroup" id="tabgroup_yJpNTehyh1-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_yJpNTehyh1-3_tabid-4" role="tab" aria-controls="tabpanel_yJpNTehyh1-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_yJpNTehyh1-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">public void EndOfInput()
{
    _targetFile.Close();
    _targetFile.Dispose();
    _targetFile = null;
}
</code></pre></section>
</div>
<h2 id="putting-everything-together">Putting Everything Together</h2>
<p>The complete file writer class should now look as shown below:</p>
<div class="tabGroup" id="tabgroup_yJpNTehyh1-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_yJpNTehyh1-4_tabid-5" role="tab" aria-controls="tabpanel_yJpNTehyh1-4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_yJpNTehyh1-4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-cs">using System.IO;
using Sdl.FileTypeSupport.Framework.BilingualApi;
using Sdl.FileTypeSupport.Framework.NativeApi;

namespace Sdk.FileTypeSupport.Samples.SimpleText
{
    class SimpleTextWriter : AbstractNativeFileWriter, INativeContentCycleAware
    {
        IPersistentFileConversionProperties _conversionProperties;
        StreamWriter _targetFile = null;

        #region &quot;members of INativecontentCycleAware member&quot;
        public void SetFileProperties(IFileProperties properties)
        {
            _conversionProperties = properties.FileConversionProperties;
        }

        #region &quot;output file&quot;
        // create the output text file
        public void StartOfInput()
        {
            _targetFile = new StreamWriter(OutputProperties.OutputFilePath);
        }
        #endregion

        #region &quot;close&quot;
        public void EndOfInput()
        {
            _targetFile.Close();
            _targetFile.Dispose();
            _targetFile = null;
        }
        #endregion
        #endregion

        #region &quot;text and tags&quot;
        // iterate through the bilingual file
        // and add translatable text content and the content of
        // any structure and inline tags to the target output file
        public override void StructureTag(IStructureTagProperties tagInfo)
        {
            _targetFile.WriteLine(tagInfo.TagContent);
        }

        public override void Text(ITextProperties textInfo)
        {
            _targetFile.Write(textInfo.Text);
        }


        public override void InlineStartTag(IStartTagProperties tagInfo)
        {
            _targetFile.Write(tagInfo.TagContent);
        }

        public override void InlineEndTag(IEndTagProperties tagInfo)
        {
            _targetFile.Write(tagInfo.TagContent);
        }

        // make sure a line break is inserted after each end of a segment
        public override void SegmentEnd()
        {
            _targetFile.WriteLine();
        }
        #endregion
    }
}
</code></pre></section>
</div>
<h2 id="reference-the-component-in-the-file-type-component-builder">Reference the Component in the File Type Component Builder</h2>
<p>Do not forget to reference the file writer class by adding the following code to the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.IntegrationApi.IFileTypeComponentBuilder.html">IFileTypeComponentBuilder</a> implementation:</p>
<div class="tabGroup" id="tabgroup_yJpNTehyh1-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_yJpNTehyh1-5_tabid-6" role="tab" aria-controls="tabpanel_yJpNTehyh1-5_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_yJpNTehyh1-5_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// Gets the file generator for this component.
/// &lt;/summary&gt;
/// &lt;param name=&quot;name&quot;&gt;not used herer&lt;/param&gt;
/// &lt;returns&gt;&lt;c&gt;Null&lt;/c&gt; if no file generator is defined&lt;/returns&gt;
public virtual IFileGenerator BuildFileGenerator(string name)
{
    var writer = new SimpleTextWriter();
    var generator = FileTypeManager.BuildFileGenerator(FileTypeManager.BuildNativeGenerator(writer));
    generator.AddFileTweaker(new SimpleFilePostTweaker());
    return generator;
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="implementing_the_preview_writer.html">Implementing the Preview Writer</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/filetypesupport/implementing_the_file_writer.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
