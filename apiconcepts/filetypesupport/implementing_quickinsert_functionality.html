<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Implementing QuickInsert Functionality </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Implementing QuickInsert Functionality ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
  
  <meta property="docfx:rel" content="../../">
  
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="implementing-quickinsert-functionality">Implementing QuickInsert Functionality</h1>

<p>QuickInsert allows you to further enhance your file type plug-in by adding functionality that allows users to quickly insert inline tags, placeholders, strings (or string pairs), characters that are difficult to type on some keyboards (e.g. ç, ©), etc.</p>
<h2 id="about-quickinsert">About QuickInsert</h2>
<p>QuickInsert (formerly QuickTag) allows the insertion of bilingual content into the localizable document using the buttons on the <strong>QuickInsert</strong> toolbar of <a href="Var:ProductName">Var:ProductName</a>. The bilingual content consists of bilingual File Type Support Framework items such as <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.BilingualApi.ITagPair.html">ITagPair</a>, <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.BilingualApi.IPlaceholderTag.html">IPlaceholderTag</a>, <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.BilingualApi.IText.html">IText</a>, <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.BilingualApi.Location.html">Location</a>, <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.BilingualApi.ICommentMarker.html">ICommentMarker</a>, or <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.BilingualApi.ILockedContent.html">ILockedContent</a>.</p>
<p>QuickInsert allows users to insert various items into their target segments:</p>
<ul>
<li><strong>Inline tags</strong>: for example, tag pairs that apply bold formatting</li>
<li><strong>Text pairs</strong>: start and end text to be inserted before and after the current selection, for example, German smart quotes to be inserted before and after the selection</li>
<li><strong>Standalone text</strong>: simple pieces of text, e.g. special characters like ®, which replaces the current selection when inserted</li>
</ul>
<p>QuickInsert items can be specific to particular file types. For example, HTML uses <strong>B</strong> tags to apply bold formatting, while DOC files use <strong>CF</strong> tags. Therefore, each file type plug-in can be associated with its own set of QuickInsert items.</p>
<p>Below you see an example of how the standard Microsoft Word 2007 file type plug-in is associated with a QuickInsert settings page that lists all the QuickInsert items defined for this file type plug-in.</p>
<div class="NOTE">
<h5>Note</h5>
<p>In the UI only QuickInserts specified by user are displayed, the default QuickInserts are only displayed on the <a href="Var:ProductName">Var:ProductName</a> toolbar.</p>
</div>
<p><img src="images/WordQuickInsert.jpg" alt="WordQuickInsert"></p>
<p>When you open a DOC file in <a href="Var:ProductName">Var:ProductName</a>, the QuickInsert toolbar will look as shown below:</p>
<p><img src="images/WordQuickInsertToolbar.jpg" alt="WordQuickInsertToolbar"></p>
<p>Since we have not assigned any QuickInsert items to our sample file type plug-in, the toolbar will look like this after opening a *<em>.text</em> file:</p>
<p><img src="images/QuickInsertToolbarNonAssigned.jpg" alt="QuickInsertToolbarNonAssigned"></p>
<p>Apart from some default assignments of characters that can be used in any format, e.g. dash, copyright, etc., all other toolbar buttons are greyed-out (i.e. not assigned).</p>
<p>Some of the inactive buttons are by default intended for applying particular types of common character formatting, e.g. bold, underline, etc. Since every format uses different tags for applying these types of formatting, the corresponding QuickInsert assignments have to be made on a file type plug-in-specific basis</p>
<p><img src="images/DefaultFormattingButtons.jpg" alt="DefaultFormattingButtons"></p>
<p>Then, there are a number of unassigned buttons that are intended for receiving customized QuickInsert items, e.g. formatting not covered by the default formatting buttons, strings, string pairs, etc. The generic icons of these buttons can be changed programmatically or through the user interface.</p>
<p><img src="images/QuickInsertCustomButtons.jpg" alt="QuickInsertCustomButtons"></p>
<h2 id="modify-the-file-type-component-builder">Modify the File Type Component Builder</h2>
<p>To associate your sample file type plug-in with a settings page that lists the QuickInsert items, the following code was used in the class <strong>SimpleTextFilterComponentBuilder</strong> within the method <strong>BuildFileTypeInformation</strong>.</p>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S_tabid-1" role="tab" aria-controls="tabpanel_bHGHmlrG6S_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S_tabid-1" role="tabpanel" data-tab="tabid-1">

<pre><code class="lang-cs">info.WinFormSettingsPageIds = new string[]
{
    &quot;SimpleText_Settings&quot;,
    &quot;QuickInserts_Settings&quot;,
};
</code></pre>
</section>
</div>

<p><strong>WinFormSettingsPageIds</strong> specifies the ids of the settings pages to be associated with a file type plug-in. Here we added <strong>QuickInserts_Settings</strong> so that a settings page that lists the QuickInsert items is associated with this file type plug-in. This code was added in an earlier chapter and so should not be added again.</p>
<p>Since a this <strong>QuickInsert</strong> settings page has been associated, a <strong>QuickInsert</strong> link will be shown below your sample file type plug-in in the <strong>Options</strong> dialog box of <a href="Var:ProductName">Var:ProductName</a>. This is the first time that you have implemented a user interface for your file type plug-in, however, the QuickInsert list is, of course, empty.</p>
<p>By clicking <strong>Add</strong> you could define your own QuickInsert items. However, this standard user interface is limited insofar as it only allows you to define items for standalone text and text pairs.</p>
<p><img src="images/QuickInsertAdd.jpg" alt="QuickInsertAdd"></p>
<h2 id="define-quickinsert-items-programmatically">Define QuickInsert Items Programmatically</h2>
<p>You could add QuickInsert items through the user interface and thus deploy them in the settings export format (**.sdlfiletype* file). However, as mentioned above, this approach has its limitations. Generating QuickInsert items programmatically gives you full control over the QuickInsert mechanism.</p>
<p>Let us assume you want to assign a <strong>B</strong> tag pair to the corresponding default button in the QuickInsert toolbar and assign German quotes (i.e. a text pair) to one of the custom QuickInsert buttons.</p>
<p>Start by adding a class called e.g. <strong>QuickInsertBuilder.cs</strong> to your project. The class needs to be derived from <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.Core.Utilities.IntegrationApi.AbstractQuickTagBuilder.html">AbstractQuickTagBuilder</a>. Your class needs to reference the namespace <strong>Sdl.FileTypeSupport.Framework.Core.Utilities.IntegrationApi</strong>. Below you see an example of an implementation that assigns the appropriate tag pair to the standard bold formatting button and a text pair (German quotes) to the first custom QuickInsert button.</p>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-1_tabid-2" role="tab" aria-controls="tabpanel_bHGHmlrG6S-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S-1_tabid-2" role="tabpanel" data-tab="tabid-2">

<pre><code class="lang-cs">using System.Collections.Generic;
using Sdl.FileTypeSupport.Framework.IntegrationApi;
using Sdl.FileTypeSupport.Framework.Core.Utilities.IntegrationApi;

namespace Sdk.FileTypeSupport.Samples.SimpleText
{
    class QuickInsertBuilder : AbstractQuickTagBuilder
    {
        public static IList&lt;IQuickTag&gt; BuildStandardQuickTags()
        {
            QuickInsertBuilder builder = new QuickInsertBuilder();
            return builder.CreateStandardQuickTags();
        }

        internal IList&lt;IQuickTag&gt; CreateStandardQuickTags()
        {
            IList&lt;IQuickTag&gt; quickTags = new List&lt;IQuickTag&gt;();

            // assign the default tag pair button for
            // applying bold formatting
            quickTags.Add(CreateDefaultTagPair(QuickTagDefaultId.Bold, &quot;&lt;b&gt;&quot;, &quot;&lt;/b&gt;&quot;, &quot;b&quot;));

            // assign a German quotes text pair to 
            // the first custom QuickInsert botton
            quickTags.Add(CreateTextPair(&quot;dequot&quot;, // command id
                StringResources.DeQuot_Command_Name, // command name
                StringResources.DeQuot_Command_Description, // command description 
                &quot;„&quot;, // start string, i.e. opening quote
                &quot;“&quot;, // end string, i.e. ending quote
                &quot;&quot;, &quot;&quot;, &quot;&quot;)); // display text, not required for text pairs, therefore left empty


            IList&lt;IQuickTag&gt; bidiTags = CreateDefaultBidiQuickTags();

            foreach (IQuickTag tag in bidiTags)
            {
                quickTags.Add(tag);
            }
            return quickTags;
        }
    }
}
</code></pre>
</section>
</div>

<p>Add the quick insert builder component to the File Type Component Builder by inserting the following code to your implementation of the <a href="../../api/filetypesupport/Sdl.FileTypeSupport.Framework.IntegrationApi.IFileTypeComponentBuilder.html">IFileTypeComponentBuilder</a> interface. If you do not add the quick insert builder then this component will never be used by the file type plug-in, even if the quick insert builder component has been implemented in the assembly.</p>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-2_tabid-3" role="tab" aria-controls="tabpanel_bHGHmlrG6S-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S-2_tabid-3" role="tabpanel" data-tab="tabid-3">

<pre><code class="lang-cs">public IQuickTagsFactory BuildQuickTagsFactory(string name)
{
    IQuickTagsFactory quickTags = FileTypeManager.BuildQuickTagsFactory();
    quickTags.GetQuickTags(null).SetStandardQuickTags(QuickInsertBuilder.BuildStandardQuickTags());
    return quickTags;
}
</code></pre>
</section>
</div>

<p>Note that you need to add the following names and values to the <strong>StringResources</strong> file:</p>
<p><img src="images/Resources4Quotes.jpg" alt="Resources4Quotes"></p>
<p>The QuickInsert toolbar for your file type plug-in should now look as shown below:</p>
<p><img src="images/QuickInsertToolbarCustomized.jpg" alt="QuickInsertToolbarCustomized"></p>
<h2 id="see-also">See Also</h2>
<p><a href="using_quickinserts.html">Using QuickInserts</a></p>
<div class="NOTE">
<h5>Note</h5>
<p>This content may be out-of-date. To check the latest information on this topic, inspect the libraries using the Visual Studio Object Browser.</p>
</div>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/filetypesupport/implementing_quickinsert_functionality.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
