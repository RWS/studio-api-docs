<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Searching Terms </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Searching Terms ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="searching-terms">Searching Terms</h1>

<p>Searching the terminology source through your term provider is arguably the most important function of your implementation. A term provider can still be useful without the editing function, but is of no use if no term look-up and term recognition functionality is available.</p>
<h2 id="how-to-search-and-recognize-terms">How to search and recognize terms</h2>
<p>When you click inside a segment in Trados Studio, the segment is scanned for any terminology contained in the term resource. If terms are recognized, they are highlighted with a red line and displayed in the <strong>Term Recognition</strong> window:</p>
<p><img style="display:block; " src="images/term_recognition.jpg"></p>
<p>You can also manually look up terms in the <strong>Termbase Search</strong> window:</p>
<p><img style="display:block; " src="images/term_search.jpg"></p>
<h2 id="how-to-implement-the-search-functionality">How to implement the search functionality</h2>
<p>Open the <strong>MyTerminologyProvider.cs</strong> class and go to the <strong>Search()</strong> function (which is implemented by the <strong>AbstractTerminologyProvider</strong> interface). This function is called when you click inside a segment or launch a search in the Termbase Search window. Note that Trados Studio passes a number of useful parameters:</p>
<ul>
<li><strong>text</strong>: the search string. When the user selects a segment in Trados Studio, this will be the source segment text. When you launch a search manually, this will be the search string entered by you.</li>
<li><strong>maxResultsCount</strong>: the maximum number of hits to show, i.e. the search depth.</li>
<li><strong>mode</strong>: the search mode, i.e. fuzzy or normal. When selecting a segment in Trados Studio, the mode is &#39;fuzzy&#39; by default. When you do a manual lookup, the search mode is &#39;normal&#39; by default (unless you clicked the <strong>Fuzzy Search</strong> button in the <strong>Termbase Search</strong>) window.</li>
<li><strong>targetRequired</strong>: boolean parameter that decides whether source terms without any target term should be shown or not. This parameter is controlled by you through the Trados Studio UI. Depending on the value returned, your implementation needs to decide whether an entry without a target term should be displayed or not.</li>
</ul>
<p>Below is the page of the Trados Studio UI where the user can, for example, determine the search depth or whether to display entries without a target term:</p>
<p><img style="display:block; " src="images/search_settings.jpg"></p>
<p>The <strong>Search</strong> function returns a list of results to be displayed in Trados Studio. In our simplified implementation, we loop through the glossary text file and look for any matching source terms. We assume that when the search mode is &#39;normal&#39;, we just check whether there are any source terms in the glossary that start with the search string. If the search string is fuzzy, we check whether there are any source terms in the glossary that are contained in the search string (i.e. in the segment). Of course, your &#39;real-life&#39; implementation might have a much more sophisticated way of performing fuzzy searches than the <strong>StartsWith()</strong> or <strong>Contains()</strong> methods. For each search result object, you set the following properties:</p>
<ul>
<li><strong>Text</strong>: the source term, this will also be the term that is going to be highlighted with a red line in Trados Studio.</li>
<li><strong>Score</strong>: the fuzzy score. In our simple implementation, we will simply set it to 100%. Depending on how you implement your fuzzy logic, you may assign different values.</li>
<li><strong>Id</strong>: the id of the entry that the search result needs to be associated with. Note that in Trados Studio, you do not output the search result list, but rather the entries that you need to construct in a different function (see below). The search result objects are linked to the entries using the unique ID. This is also the reason why, in our implementation, every line in the glossary file is preceded with a unique number.</li>
</ul>
<p>The <strong>Search()</strong> function of our implementation would look as shown below:</p>
<div class="tabGroup" id="tabgroup_3H82O7WGLk">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_3H82O7WGLk_tabid-1" role="tab" aria-controls="tabpanel_3H82O7WGLk_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">The Search Function</a>
</li>
</ul>
<section id="tabpanel_3H82O7WGLk_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-csharp" name="MyTerminologyProvider">//Is executed when the user launches a lookup operation in the Termbase Search window, 
//or when the user moves to a segment in the Editor of Studio. Moving to a segment
//automatically launches a fuzzy search to retrieve any known terminology.
public override IList&lt;ISearchResult&gt; Search(string text, ILanguage source, ILanguage destination, int maxResultsCount, SearchMode mode, bool targetRequired)
{
    string[] chunks;
    List&lt;string&gt; hits = new List&lt;string&gt;();

    // open the glossary text file
    using (StreamReader glossary = new StreamReader(fileName.Replace(&quot;file:///&quot;, &quot;&quot;)))
    {
        // skip the first line, as it contains only the language settings
        glossary.ReadLine();

        while (!glossary.EndOfStream)
        {
            string thisLine = glossary.ReadLine();
            if (thisLine.Trim() == &quot;&quot;)
                continue;
            chunks = thisLine.Split(&#39;;&#39;);
            string sourceTerm = chunks[1].ToLower();

            // normal search (triggered from the Termbase Search window)
            if (mode.ToString() == &quot;Normal&quot; &amp;&amp; sourceTerm.StartsWith(text.ToLower()))
                hits.Add(thisLine);

            // fuzzy search (corresponds to the Terminology Eecognition)
            if (mode.ToString() == &quot;Fuzzy&quot; &amp;&amp; text.ToLower().Contains(sourceTerm))
                hits.Add(thisLine);
        }
    }

    // Create search results object (hitlist)
    var results = new List&lt;ISearchResult&gt;();

    for (int i = 0; i &lt; hits.Count; i++)
    {
        chunks = hits[i].Split(&#39;;&#39;);
        // We create the search result object based on the source term
        // found in the glossary, we assign the id, which associates the search
        // result to the correspoinding entry, and we assume that the search score 
        // is always 100%.
        SearchResult result = new SearchResult
        {
            Text = chunks[1], // source term
            Score = 100,
            Id = Convert.ToInt32(chunks[0]) // entry id
        };

        // Construct the entry object for the current search result
        _entry.Add(CreateEntry(chunks[0], chunks[1], chunks[2], chunks[3], destination.Name));

        results.Add(result);
    }
    return results;            
}
</code></pre></section>
</div>
<p>As mentioned above, the results list needs to be associated with the corresponding entry that you construct in the following helper function:</p>
<div class="tabGroup" id="tabgroup_3H82O7WGLk-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_3H82O7WGLk-1_tabid-2" role="tab" aria-controls="tabpanel_3H82O7WGLk-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">Constructing the Entry Content</a>
</li>
</ul>
<section id="tabpanel_3H82O7WGLk-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-csharp" name="MyTerminologyProvider">// This helper function is used to construct the entry content with entry id, source and target term, and
// definition (if applicable)
private IEntry CreateEntry(string id, string sourceTerm, string targetTerm, string definitionText, string targetLanguage)
{
    // Assign the entry id
    IEntry thisEntry = new Entry
    {
        Id = Convert.ToInt32(id)
    };

    // Add the target language
    IEntryLanguage trgLanguage = new EntryLanguage
    {
        Name = targetLanguage
    };

    // Create the target term
    IEntryTerm _term = new EntryTerm
    {
        Value = targetTerm
    };
    trgLanguage.Terms.Add(_term);
    thisEntry.Languages.Add(trgLanguage);

    // Also add the definition (if available)
    if (definitionText != &quot;&quot;)
    { 
        IEntryField _definition = new EntryField
        {
            Name = &quot;Definition&quot;,
            Value = definitionText
        };
        thisEntry.Fields.Add(_definition);
    }            

    return thisEntry;
}
</code></pre></section>
</div>
<p>Make sure that you add the following entry list object to the terminology provider class:</p>
<div class="tabGroup" id="tabgroup_3H82O7WGLk-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_3H82O7WGLk-2_tabid-3" role="tab" aria-controls="tabpanel_3H82O7WGLk-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">The Entry List Object</a>
</li>
</ul>
<section id="tabpanel_3H82O7WGLk-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-csharp" name="MyTerminologyProvider">
private List&lt;IEntry&gt; _entry = new List&lt;IEntry&gt;();

</code></pre></section>
</div>
<p>Besides the <strong>Search()</strong> method, the term provider interface also calls the <strong>GetEntry()</strong> method, which then outputs the entry with the corresponding entry based on the id parameter:</p>
<div class="tabGroup" id="tabgroup_3H82O7WGLk-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_3H82O7WGLk-3_tabid-4" role="tab" aria-controls="tabpanel_3H82O7WGLk-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">Getting the Entries</a>
</li>
</ul>
<section id="tabpanel_3H82O7WGLk-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-csharp" name="MyTerminologyProvider">// Returns the entry for a search result. The entries are associated with the search results
// through the entry id.
public override IEntry GetEntry(int id)
{
    return _entry.FirstOrDefault(_entry =&gt; _entry.Id == id);
}
</code></pre></section>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/terminology/searching_terms.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
