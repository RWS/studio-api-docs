<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Adding the Main GUI </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Adding the Main GUI ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="adding-the-main-gui">Adding the Main GUI</h1>

<p>This page describes how to set up the main application form that is used to enter search strings and display the search results.</p>
<h2 id="add-the-main-application-form">Add the Main Application Form</h2>
<p>Apart from the main application form we will need other forms for selecting the TM and for configuring search settings. Therefore add a folder called <strong>GUI</strong> to your project that will contain all the application forms. Then add a form called <code>frmLookup</code>, which will be used to enter search strings and display results.</p>
<p>Add the following elements to your form:</p>
<ul>
<li><strong>txtSearch</strong>: the text field into which the search strings are entered. Make sure to set the <strong>Multiline</strong> property to True.</li>
<li><strong>txtTmPath</strong>: contains the TM file name and path or the server URI and TM name, depending on whether the user has selected a file TM or a server TM. This text field should be disabled, i.e. read-only to prevent users from changing the value after the TM has been properly selected through the GUI. Set the <em>Modifiers</em> of this control to <em>Public</em>.</li>
<li><strong>btnSelectTm</strong>: button for selecting the TM to use for the search. Opens a context menu (see item below), which offers a choice between file and server TMs.</li>
<li><strong>contextMenuTm</strong>: a context menu that is opened through the <strong>Select TM</strong> button. This menu features the options <em>Select File TM</em> and <em>Select Server TM</em> for selecting either type of translation memory.</li>
</ul>
<p><img style="display:block; " src="images/ContextMenuStrip.jpg"></p>
<ul>
<li><strong>comboIndex</strong>: the combo box through which users can select whether the search should be done in the source or in the target language; the items collection needs to contain the values <strong>Source</strong> and <strong>Target</strong>, with the <code>Text</code> property being <strong>Source</strong> (i.e. <em>Source</em> should be the default value)</li>
<li><strong>btnSearch</strong>: the button that is used to trigger the concordance search</li>
<li><strong>richTextBox</strong>: a rich text control element that we will use to display the search results</li>
<li><strong>menuStrip</strong>: application <strong>Settings</strong> menu that allows users to fine-tune the search options
<em>**btnClose</em>*: button element that closes the main window and exits the application</li>
<li><strong>comboLanguagePairs</strong>: the combo list element that contains the language directions available in the selected TM. Note that file-based TMs only offer a single language direction, whereas server TMs can have multiple language pairs. Set the <em>Modifiers</em> of this control to <em>Public</em>.</li>
<li><strong>openFileDialog</strong>: dialog box for selecting the file TM. Set the <em>Filter</em> property to <em>Translation Memories (</em>.sdltm)|<em>.sdltm</em></li>
</ul>
<p>The form should look as shown below:</p>
<p><img style="display:block; " src="images/frmLookupMain.jpg"></p>
<h2 id="implement-the-gui-functionality">Implement the GUI Functionality</h2>
<h3 id="menu-functions">Menu Functions</h3>
<p>Clicking the menu items should open the corresponding form, i.e. the form for configuring the search settings:</p>
<div class="tabGroup" id="tabgroup_rGaGb4ZSv0">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_rGaGb4ZSv0_tabid-1" role="tab" aria-controls="tabpanel_rGaGb4ZSv0_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_rGaGb4ZSv0_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">private void searchOptionsToolStripMenuItem_Click(object sender, EventArgs e)
{
    settings.Show();
}
</code></pre></section>
</div>
<h3 id="closing-the-application">Closing the Application</h3>
<p>Clicking the <strong>Close</strong> button should exit the application:</p>
<div class="tabGroup" id="tabgroup_rGaGb4ZSv0-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_rGaGb4ZSv0-1_tabid-2" role="tab" aria-controls="tabpanel_rGaGb4ZSv0-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_rGaGb4ZSv0-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">private void btnClose_Click(object sender, EventArgs e)
{
    Application.Exit();
}
</code></pre></section>
</div>
<h3 id="selecting-the-file-based-tm">Selecting the File-based TM</h3>
<p>When the corresponding command in the context menu is clicked, you raise the open file dialog, in which the file TM can be selected. The complete file name is entered into the main application form, as is the TM language direction:</p>
<div class="tabGroup" id="tabgroup_rGaGb4ZSv0-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_rGaGb4ZSv0-2_tabid-3" role="tab" aria-controls="tabpanel_rGaGb4ZSv0-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_rGaGb4ZSv0-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">private void selectFileTMToolStripMenuItem_Click(object sender, EventArgs e)
{
    // Raise open file dialog.
    this.openFileDialog.Title = &quot;Select Translation Memory File&quot;;
    this.openFileDialog.Filter = &quot;Translation memories (*.sdltm)|*.sdltm&quot;;

    // Check whether an *.sdltm file was selected
    if (this.openFileDialog.ShowDialog() == DialogResult.OK)
    {
        // Create a new connector object to connect to the file TM
        Connector fileConnect = new Connector();
        fileConnect.SelectFileTm(this.openFileDialog.FileName);
        this.txtTmPath.Text = this.openFileDialog.FileName;

        // File TMs have only one language direction, which is filled into the 
        // language pair list.
        string srcLang = Connector.fileTm.LanguageDirection.SourceLanguage.DisplayName.ToString();
        string trgLang = Connector.fileTm.LanguageDirection.TargetLanguage.DisplayName.ToString();

        this.comboLanguagePairs.Items.Clear();
        this.comboLanguagePairs.Text =  srcLang + &quot; -&gt; &quot; + trgLang;
    }
}
</code></pre></section>
</div>
<h3 id="raising-the-form-for-server-tm-selection">Raising the Form for Server TM Selection</h3>
<p>Selecting a server TM requires users to enter more than just a file name and path. This is why the second command in the context menu raises a separate form, in which the server URI and user credentials are entered:</p>
<div class="tabGroup" id="tabgroup_rGaGb4ZSv0-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_rGaGb4ZSv0-3_tabid-4" role="tab" aria-controls="tabpanel_rGaGb4ZSv0-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_rGaGb4ZSv0-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">private void selectServerTMToolStripMenuItem_Click(object sender, EventArgs e)
{
    frmSelectTM selectTm = new frmSelectTM();
    selectTm.Show();
}
</code></pre></section>
</div>
<h3 id="initializing-the-default-search-settings">Initializing the Default Search Settings</h3>
<p>When the application is started, the form for configuring the search settings should get the default settings, which - in our implementation - are identical to the settings used by Trados Studio, i.e. 70% as the minimum fuzzy match value and 30 as the maximum number of results that a concordance search should return. Note that both of these settings can have an impact on the search speed.</p>
<div class="tabGroup" id="tabgroup_rGaGb4ZSv0-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_rGaGb4ZSv0-4_tabid-5" role="tab" aria-controls="tabpanel_rGaGb4ZSv0-4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_rGaGb4ZSv0-4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-cs">// Initialize form with default search settings.
public frmLookup()
{
    InitializeComponent();
    frmSettings.maxHits = 30;
    frmSettings.minFuzzy = 70;
}
</code></pre></section>
</div>
<h3 id="executing-the-search">Executing the Search</h3>
<p>By clicking the Search button the corresponding function in the (yet to be implemented) Search class should be triggered. This function requires the search string (entered into the txtSearch text field, the source/target flag (as set through the comboIndex list) as parameters. In addition it requires the language pair index, which is provided by the comboLanguagePairs control element, as server TMs can have multiple language pairs:</p>
<div class="tabGroup" id="tabgroup_rGaGb4ZSv0-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_rGaGb4ZSv0-5_tabid-6" role="tab" aria-controls="tabpanel_rGaGb4ZSv0-5_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_rGaGb4ZSv0-5_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-cs">private void btnSearch_Click(object sender, EventArgs e)
{            
    try
    {
        #region &quot;SearchObject&quot;
        Search search = new Search();
        #endregion

        #region &quot;SourceOrTarget&quot;
        // Determine whether to do the concordance search in the
        // source or in the target language;
        bool searchTarget;
        if (this.comboIndex.Text == &quot;Target&quot;)
            searchTarget = true;
        else
            searchTarget = false;
        #endregion

        #region &quot;FillHitlist&quot;
        // Fill the search result into the rich text box.
        this.lblHitCount.Text = search.DoConcordanceSearch(this.txtSearch.Text, searchTarget, 
            comboLanguagePairs.SelectedIndex);
        #endregion
    }
    catch(Exception ex)
    {
        MessageBox.Show(&quot;No TM selected.&quot; + ex.Message);
    }
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="adding_the_server_tm_selection_form.html">Adding the Server TM Selection Form</a></p>
<p><a href="adding_the_search_settings_form.html">Adding the Search Settings Form</a></p>
<p><a href="adding_the_connector_class.html">Adding the Connector Class</a></p>
<p><a href="implementing_the_search_functionality.html">Implementing the Search Functionality</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/translationmemory/adding_the_main_gui.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
