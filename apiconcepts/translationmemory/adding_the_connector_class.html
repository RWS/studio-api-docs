<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Adding the Connector Class </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Adding the Connector Class ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="adding-the-connector-class">Adding the Connector Class</h1>

<p>This page explains how to implement the class that establishes a connection to the TM. Depending on the choice made on the form for selecting the TM you will either have to open a file TM, or connect to a server TM.</p>
<h2 id="file-or-server-tm">File or Server TM?</h2>
<p>This class makes the basic determination of whether a file or server TM should be used when carrying out the searches. The choice is represented by a public static boolean member, which can be set and queried later from the main lookup form:</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY_tabid-1" role="tab" aria-controls="tabpanel_AAzFBMzLYY_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// Property to flag whether a file or server TM should be used for the search
/// &lt;/summary&gt; 
public static bool server
{
    get;
    set;
}
</code></pre></section>
</div>
<h2 id="select-the-file-tm">Select the File TM</h2>
<p>On the corresponding form (see <a href="adding_the_server_tm_selection_form.html">Adding the Server TM Selection Form</a>) the user raises a <strong>File Open</strong> dialog for selecting the required <em>*.sdltm</em> file. The following class member is used to create the file TM object, to which the searches are applied later (see <a href="implementing_the_search_functionality.html">Implementing the Search Functionality</a>).</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-1_tabid-2" role="tab" aria-controls="tabpanel_AAzFBMzLYY-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// Select the file TM using the file name and path chosen by the user through the GUI.
/// &lt;/summary&gt;
public void SelectFileTm(string tmPath)
{
    fileTm = new FileBasedTranslationMemory(tmPath);
    server = false;
}
</code></pre></section>
</div>
<p>The file TM object is declared as a public static member:</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-2_tabid-3" role="tab" aria-controls="tabpanel_AAzFBMzLYY-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// The file TM object
/// &lt;/summary&gt; 
public static FileBasedTranslationMemory fileTm
{
    get;
    set;           
}
</code></pre></section>
</div>
<h2 id="select-the-server-tm">Select the Server TM</h2>
<p>Selecting a server TM is somewhat more demanding, as it requires you to establish a successful connection to the TM Server. First, declare the server TM object as a public static class member, which can later be used by the search functionality (see <a href="implementing_the_search_functionality.html">Implementing the Search Functionality</a>).</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-3_tabid-4" role="tab" aria-controls="tabpanel_AAzFBMzLYY-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// The server TM object
/// &lt;/summary&gt;
public static ServerBasedTranslationMemory serverTM
{
    get;
    set;
}
</code></pre></section>
</div>
<p>Also, declare the translation provider server object as a private class member:</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-4_tabid-5" role="tab" aria-controls="tabpanel_AAzFBMzLYY-4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-cs">private TranslationProviderServer tmServer;
</code></pre></section>
</div>
<p>Next, add the following function, which establishes the server connection. The function does the following:</p>
<ul>
<li>Establish the server connection by creating a new translation server provider object. This requires the user credentials and the server URI, which are returned by separate members.</li>
<li>After successfully connecting to the server, the combo list is filled with the server TM names by applying the <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.TranslationProviderServer.html#Sdl_LanguagePlatform_TranslationMemoryApi_TranslationProviderServer_GetTranslationMemories_Sdl_LanguagePlatform_TranslationMemoryApi_TranslationMemoryProperties_">GetTranslationMemories</a> method to the translation provider server object, and the list element gets enabled. Note that the full TM path including the organization name is required for selecting a TM (e.g. <em>Root Organization/TM Name</em>). In this example we make sure to populate the dropdown list for the TM selection with the full TM path including the organization name.</li>
<li>Also, the name of the first server TM is retrieved, and the list is set by default to the name of the first server TM.</li>
</ul>
<div class="NOTE"><h5>Note</h5><p>Since a number of things may go wrong when establishing the server connection (e.g. server not available, incorrect password, etc.), you should properly catch any exceptions. (For this example we assume that we are not using Windows logins, but RWS logins, so the useWindowsAuthentication flag is set to False.)</p>
</div>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-5_tabid-6" role="tab" aria-controls="tabpanel_AAzFBMzLYY-5_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-5_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// Establishing a connection to the TM Server.
/// This connection is primarily needed for populating the 
/// TM dropdown list with the TM names.
/// &lt;/summary&gt;
public void Connect(string serverUri, string userName, string password, ComboBox tmList)
{
    try
    {
        tmServer = new TranslationProviderServer(GetUri(serverUri),  false, userName, password);
        foreach (ServerBasedTranslationMemory item in tmServer.GetTranslationMemories(TranslationMemoryProperties.All))
        {
            //Resolve path to the TM inclusive name of the organization(s)
            string tmPath = item.ParentResourceGroupPath == &quot;/&quot; ? &quot;&quot; : item.ParentResourceGroupPath;
            tmList.Items.Add(tmPath + &quot;/&quot; + item.Name);
        }

        if (tmList.Items.Count &gt; 0)
        {
            tmList.Enabled = true;
            tmList.SelectedIndex = 0;
        }
    }
    catch(Exception ex)
    {
        MessageBox.Show(ex.Message);
    }

}
</code></pre></section>
</div>
<p>As mentioned above, the server URI is returned by a separate member:</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-6">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-6_tabid-7" role="tab" aria-controls="tabpanel_AAzFBMzLYY-6_tabid-7" data-tab="tabid-7" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-6_tabid-7" role="tabpanel" data-tab="tabid-7">
<pre><code class="lang-cs">/// Returns the address of the TM Server.
/// &lt;/summary&gt;
private Uri GetUri(string uri)
{
    string address = uri;
    return new Uri(address);
}
</code></pre></section>
</div>
<p>Last, when the user clicks the <strong>OK</strong> button on the TM selection form (see <a href="adding_the_server_tm_selection_form.html">Adding the Server TM Selection Form</a>), the server TM that was chosen by the user through the dropdown list actually gets selected for all subsequent concordance searches. The <strong>OK</strong> button triggers the following function for selecting the TM. Here, another translation provider server connection is made using the URI and the user credentials.</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-7">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-7_tabid-8" role="tab" aria-controls="tabpanel_AAzFBMzLYY-7_tabid-8" data-tab="tabid-8" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-7_tabid-8" role="tabpanel" data-tab="tabid-8">
<pre><code class="lang-cs">/// &lt;summary&gt;
/// Selects the particular server TM as chosen by the user through the dropdown list.
/// &lt;/summary&gt;
public void SelectServerTm(string tmName, string uri, string userName, string password)
{
    tmServer = new TranslationProviderServer(GetUri(uri), false, userName, password);
    serverTM = tmServer.GetTranslationMemory(tmName, 
        TranslationMemoryProperties.None);
    server = true;
}
</code></pre></section>
</div>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<p>The complete class should look as shown below:</p>
<div class="tabGroup" id="tabgroup_AAzFBMzLYY-8">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_AAzFBMzLYY-8_tabid-9" role="tab" aria-controls="tabpanel_AAzFBMzLYY-8_tabid-9" data-tab="tabid-9" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_AAzFBMzLYY-8_tabid-9" role="tabpanel" data-tab="tabid-9">
<pre><code class="lang-cs">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Sdl.LanguagePlatform.TranslationMemoryApi;
using Sdl.LanguagePlatform.TranslationMemory;
using Sdl.LanguagePlatform.Core.Tokenization;
using Sdl.LanguagePlatform.Core;

namespace SDK.LanguagePlatform.Samples.TmLookup
{
    class Connector
    {
        #region &quot;TmServer&quot;
        private TranslationProviderServer tmServer;
        #endregion        

        #region &quot;FileOrServer&quot;
        /// &lt;summary&gt;
        /// Property to flag whether a file or server TM should be used for the search
        /// &lt;/summary&gt; 
        public static bool server
        {
            get;
            set;
        }
        #endregion

        #region &quot;fileTM&quot;
        /// &lt;summary&gt;
        /// The file TM object
        /// &lt;/summary&gt; 
        public static FileBasedTranslationMemory fileTm
        {
            get;
            set;           
        }
        #endregion



        #region &quot;SelectFileTm&quot;
        /// &lt;summary&gt;
        /// Select the file TM using the file name and path chosen by the user through the GUI.
        /// &lt;/summary&gt;
        public void SelectFileTm(string tmPath)
        {
            fileTm = new FileBasedTranslationMemory(tmPath);
            server = false;
        }
        #endregion

        #region &quot;serverTM&quot;
        /// &lt;summary&gt;
        /// The server TM object
        /// &lt;/summary&gt;
        public static ServerBasedTranslationMemory serverTM
        {
            get;
            set;
        }
        #endregion

        #region &quot;connect&quot;
        /// &lt;summary&gt;
        /// Establishing a connection to the TM Server.
        /// This connection is primarily needed for populating the 
        /// TM dropdown list with the TM names.
        /// &lt;/summary&gt;
        public void Connect(string serverUri, string userName, string password, ComboBox tmList)
        {
            try
            {
                tmServer = new TranslationProviderServer(GetUri(serverUri),  false, userName, password);
                foreach (ServerBasedTranslationMemory item in tmServer.GetTranslationMemories(TranslationMemoryProperties.All))
                {
                    //Resolve path to the TM inclusive name of the organization(s)
                    string tmPath = item.ParentResourceGroupPath == &quot;/&quot; ? &quot;&quot; : item.ParentResourceGroupPath;
                    tmList.Items.Add(tmPath + &quot;/&quot; + item.Name);
                }

                if (tmList.Items.Count &gt; 0)
                {
                    tmList.Enabled = true;
                    tmList.SelectedIndex = 0;
                }
            }
            catch(Exception ex)
            {
                MessageBox.Show(ex.Message);
            }

        }
        #endregion


        #region &quot;uri&quot;
        /// &lt;summary&gt;
        /// Returns the address of the TM Server.
        /// &lt;/summary&gt;
        private Uri GetUri(string uri)
        {
            string address = uri;
            return new Uri(address);
        }
        #endregion


        #region &quot;SelectServerTm&quot;
        /// &lt;summary&gt;
        /// Selects the particular server TM as chosen by the user through the dropdown list.
        /// &lt;/summary&gt;
        public void SelectServerTm(string tmName, string uri, string userName, string password)
        {
            tmServer = new TranslationProviderServer(GetUri(uri), false, userName, password);
            serverTM = tmServer.GetTranslationMemory(tmName, 
                TranslationMemoryProperties.None);
            server = true;
        }
        #endregion
    }
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="implementing_the_search_functionality.html">Implementing the Search Functionality</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/main/apiconcepts/translationmemory/adding_the_connector_class.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
