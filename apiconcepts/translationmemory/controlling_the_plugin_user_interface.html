<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Controlling the Plug-in User Interface </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Controlling the Plug-in User Interface ">
    <meta name="generator" content="docfx 2.58.4.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <span class="glyphicon glyphicon-search search-icon"></span>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar-default">
          <div class="container hide-when-search">
            <div class="breadcrumb-container" id="breadcrumb">
              <ul class="breadcrumb col-md-10">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="controlling-the-plug-in-user-interface">Controlling the Plug-in User Interface</h1>

<p>The translation provider plug-in template contains a component called <code>MyTranslationProviderWinFormsUI</code>, which we re-name to <code>ListTranslationProviderWinFormsUI</code> for our implementation. This component is used to:</p>
<ul>
<li>Control the appearance of the plug-in when it is displayed in Trados Studio, e.g. the plug-in name, icon, tooltip</li>
<li>Raise the plug-in user interface</li>
<li>Obtain credentials from the user, which is not required for our sample implementation</li>
</ul>
<p>The class is preceded by the following declaration, which defines it as an extension class, which will be referenced and declared to the Trados Studio application through the plug-in manifest *.xml file (see also <a href="building_the_plugin.html">Building the Plug-in</a>).</p>
<div class="tabGroup" id="tabgroup_dDzYvXLsgM">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_dDzYvXLsgM_tabid-1" role="tab" aria-controls="tabpanel_dDzYvXLsgM_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_dDzYvXLsgM_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-cs">[TranslationProviderWinFormsUi(
    Id = &quot;ListTranslationProviderWinFormsUI&quot;,
    Name = &quot;ListTranslationProviderWinFormsUI&quot;,
    Description = &quot;ListTranslationProviderWinFormsUI&quot;)]
</code></pre></section>
</div>
<p>This class implements the <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.ITranslationProviderWinFormsUI.html">ITranslationProviderWinFormsUI</a> interface. Below you see how we use the members of this interface in our implementation.</p>
<h2 id="browse-for-the-plug-in">Browse for the Plug-in</h2>
<p>The UI extension allows users to browse for and select translation providers in a unified way. This is done by the user when opening a document for translation or when adding translation providers to a project through the <strong>Add</strong> button in the UI of Trados Studio as illustrated in the screenshot below:</p>
<p><img style="display:block; " src="images/BrowsePlugin.jpg"></p>
<p>Some translation providers do not require a user interface for configuring settings. In our implementation, however, a form is used to enter the required settings, which we raise through the <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.ITranslationProviderWinFormsUI.html#Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderWinFormsUI_Browse_System_Windows_Forms_IWin32Window_Sdl_LanguagePlatform_Core_LanguagePair___Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderCredentialStore_">Browse</a> method of the interface:</p>
<div class="tabGroup" id="tabgroup_dDzYvXLsgM-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_dDzYvXLsgM-1_tabid-2" role="tab" aria-controls="tabpanel_dDzYvXLsgM-1_tabid-2" data-tab="tabid-2" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_dDzYvXLsgM-1_tabid-2" role="tabpanel" data-tab="tabid-2">
<pre><code class="lang-cs">public ITranslationProvider[] Browse(IWin32Window owner, LanguagePair[] languagePairs, ITranslationProviderCredentialStore credentialStore)
{
    ListProviderConfDialog dialog = new ListProviderConfDialog(new ListTranslationOptions());
    if (dialog.ShowDialog(owner) == DialogResult.OK)
    {
        ListTranslationProvider testProvider = new ListTranslationProvider(dialog.Options);
        return new ITranslationProvider[] { testProvider };   
    }
    return null;
}
</code></pre></section>
</div>
<p>Translation provider plug-ins that implement a user interface for configuring settings will usually allow users to change those settings later. For example, users might want to change the plug-in settings while translating, as they discover that a different list file is more suitable for the text that they have selected. For this, the UI of Trados Studio implements a <strong>Settings</strong> button, which can be enabled or disabled through your plug-in (see screenshot below).</p>
<p><img style="display:block; " src="images/ProviderSettingsButton.jpg"></p>
<p>For our sample plug-in it makes sense to enable this button and allow for any settings to be changed. To do this, we set the <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.ITranslationProviderWinFormsUI.html#Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderWinFormsUI_SupportsEditing">SupportsEditing</a> property to return <code>True</code>:</p>
<div class="tabGroup" id="tabgroup_dDzYvXLsgM-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_dDzYvXLsgM-2_tabid-3" role="tab" aria-controls="tabpanel_dDzYvXLsgM-2_tabid-3" data-tab="tabid-3" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_dDzYvXLsgM-2_tabid-3" role="tabpanel" data-tab="tabid-3">
<pre><code class="lang-cs">public bool SupportsEditing
{
    get { return true; }
}
</code></pre></section>
</div>
<p>Consequently, the <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.ITranslationProviderWinFormsUI.html#Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderWinFormsUI_Edit_System_Windows_Forms_IWin32Window_Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProvider_Sdl_LanguagePlatform_Core_LanguagePair___Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderCredentialStore_">Edit</a> method is then used for the same purpose as the <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.ITranslationProviderWinFormsUI.html#Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderWinFormsUI_Browse_System_Windows_Forms_IWin32Window_Sdl_LanguagePlatform_Core_LanguagePair___Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderCredentialStore_">Browse</a> method, i.e. to raise the plug-in user interface:</p>
<div class="tabGroup" id="tabgroup_dDzYvXLsgM-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_dDzYvXLsgM-3_tabid-4" role="tab" aria-controls="tabpanel_dDzYvXLsgM-3_tabid-4" data-tab="tabid-4" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_dDzYvXLsgM-3_tabid-4" role="tabpanel" data-tab="tabid-4">
<pre><code class="lang-cs">public bool Edit(IWin32Window owner, ITranslationProvider translationProvider, LanguagePair[] languagePairs, ITranslationProviderCredentialStore credentialStore)
{
    ListTranslationProvider editProvider = translationProvider as ListTranslationProvider;
    if (editProvider == null)
    {
        return false;
    }

    ListProviderConfDialog dialog = new ListProviderConfDialog(editProvider.Options);
    if (dialog.ShowDialog(owner) == DialogResult.OK)
    {
        editProvider.Options = dialog.Options;
        return true;
    }

    return false;
}
</code></pre></section>
</div>
<p>The plug-in user interface of our implementation will look as shown below:</p>
<p><img style="display:block; " src="images/PluginGui.jpg"></p>
<h2 id="user-authentication">User Authentication</h2>
<p>Through the <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.ITranslationProviderWinFormsUI.html#Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderWinFormsUI_GetCredentialsFromUser_System_Windows_Forms_IWin32Window_System_Uri_System_String_Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderCredentialStore_">GetCredentialsFromUser</a> method of the interface we can retrieve user credentials that may be required for connecting to the translation provider. For example, when you connect to a server TM or a Web-based translation service, a user name and login may be required. Very often, you may want to store the login information, so that users are not required have to enter the name and password every time that they connect to the provider.</p>
<p>In our simple implementation, however, we only access a text file, which means that no user authentication is necessary. We can therefore have this method return always True:</p>
<div class="tabGroup" id="tabgroup_dDzYvXLsgM-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_dDzYvXLsgM-4_tabid-5" role="tab" aria-controls="tabpanel_dDzYvXLsgM-4_tabid-5" data-tab="tabid-5" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_dDzYvXLsgM-4_tabid-5" role="tabpanel" data-tab="tabid-5">
<pre><code class="lang-cs">public bool GetCredentialsFromUser(IWin32Window owner, Uri translationProviderUri, string translationProviderState, ITranslationProviderCredentialStore credentialStore)
{            
    return true;
}
</code></pre></section>
</div>
<h2 id="display-the-plug-in-info">Display the Plug-in Info</h2>
<p>The <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.ITranslationProviderWinFormsUI.html#Sdl_LanguagePlatform_TranslationMemoryApi_ITranslationProviderWinFormsUI_GetDisplayInfo_System_Uri_System_String_">GetDisplayInfo</a> is used to display information such as the plug-in name, icon, etc. in the user interface of Trados Studio. This information is stored in the resources file (see <a href="the_resources_file.html">The Resources File</a>). Within this method we first create a <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.TranslationProviderDisplayInfo.html">TranslationProviderDisplayInfo</a> object, and then set the various properties, i.e. plug-in display name, the tooltip text, and the translation provider icon. This information will then be shown in the application as illustrated below:</p>
<p><img style="display:block; " src="images/PluginResourcesInAction.jpg"></p>
<p>The <a href="../../api/translationmemory/Sdl.LanguagePlatform.TranslationMemoryApi.TranslationProviderDisplayInfo.html#Sdl_LanguagePlatform_TranslationMemoryApi_TranslationProviderDisplayInfo_SearchResultImage">SearchResultImage</a> property sets the image that is shown in the <strong>Translation Results</strong> or <strong>Concordance</strong> window of Trados Studio, which helps users ascertain more quickly by which provider a translation solution has been suggested (see screenshot below):</p>
<p><img style="display:block; " src="images/PngForShowingResults.jpg"></p>
<div class="tabGroup" id="tabgroup_dDzYvXLsgM-5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_dDzYvXLsgM-5_tabid-6" role="tab" aria-controls="tabpanel_dDzYvXLsgM-5_tabid-6" data-tab="tabid-6" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_dDzYvXLsgM-5_tabid-6" role="tabpanel" data-tab="tabid-6">
<pre><code class="lang-cs">public TranslationProviderDisplayInfo GetDisplayInfo(Uri translationProviderUri, string translationProviderState)
{
    TranslationProviderDisplayInfo info = new TranslationProviderDisplayInfo();
    info.Name = PluginResources.Plugin_NiceName;            
    info.TranslationProviderIcon = PluginResources.band_aid_icon;
    info.TooltipText = PluginResources.Plugin_Tooltip;

    info.SearchResultImage = PluginResources.band_aid_symbol;

    return info;
}
</code></pre></section>
</div>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<p>The complete component should look as shown below:</p>
<div class="tabGroup" id="tabgroup_dDzYvXLsgM-6">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_dDzYvXLsgM-6_tabid-7" role="tab" aria-controls="tabpanel_dDzYvXLsgM-6_tabid-7" data-tab="tabid-7" tabindex="0" aria-selected="true">C#</a>
</li>
</ul>
<section id="tabpanel_dDzYvXLsgM-6_tabid-7" role="tabpanel" data-tab="tabid-7">
<pre><code class="lang-cs">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Sdl.LanguagePlatform.Core;
using Sdl.LanguagePlatform.TranslationMemory;
using Sdl.LanguagePlatform.TranslationMemoryApi;

namespace Sdk.LanguagePlatform.Samples.ListProvider
{
    #region &quot;Declaration&quot;
    [TranslationProviderWinFormsUi(
        Id = &quot;ListTranslationProviderWinFormsUI&quot;,
        Name = &quot;ListTranslationProviderWinFormsUI&quot;,
        Description = &quot;ListTranslationProviderWinFormsUI&quot;)]
    #endregion
    public class ListTranslationProviderWinFormsUI : ITranslationProviderWinFormsUI
    {
        #region ITranslationProviderWinFormsUI Members


        /// &lt;summary&gt;
        /// Show the plug-in settings form when the user is adding the translation provider plug-in
        /// through the GUI of Trados Studio
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;owner&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;languagePairs&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;credentialStore&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        #region &quot;Browse&quot;
        public ITranslationProvider[] Browse(IWin32Window owner, LanguagePair[] languagePairs, ITranslationProviderCredentialStore credentialStore)
        {
            ListProviderConfDialog dialog = new ListProviderConfDialog(new ListTranslationOptions());
            if (dialog.ShowDialog(owner) == DialogResult.OK)
            {
                ListTranslationProvider testProvider = new ListTranslationProvider(dialog.Options);
                return new ITranslationProvider[] { testProvider };   
            }
            return null;
        }
        #endregion



        /// &lt;summary&gt;
        /// Determines whether the plug-in settings can be changed
        /// by displaying the Settings button in Trados Studio.
        /// &lt;/summary&gt;
        #region &quot;SupportsEditing&quot;
        public bool SupportsEditing
        {
            get { return true; }
        }
        #endregion

        /// &lt;summary&gt;
        /// If the plug-in settings can be changed by the user,
        /// Trados Studio will display a Settings button.
        /// By clicking this button, users raise the plug-in user interface,
        /// in which they can modify any applicable settings, in our implementation
        /// the delimiter character and the list file name.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;owner&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;translationProvider&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;languagePairs&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;credentialStore&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        #region &quot;Edit&quot;
        public bool Edit(IWin32Window owner, ITranslationProvider translationProvider, LanguagePair[] languagePairs, ITranslationProviderCredentialStore credentialStore)
        {
            ListTranslationProvider editProvider = translationProvider as ListTranslationProvider;
            if (editProvider == null)
            {
                return false;
            }

            ListProviderConfDialog dialog = new ListProviderConfDialog(editProvider.Options);
            if (dialog.ShowDialog(owner) == DialogResult.OK)
            {
                editProvider.Options = dialog.Options;
                return true;
            }

            return false;
        }
        #endregion

        /// &lt;summary&gt;
        /// Can be used in implementations in which a user login is required, e.g.
        /// for connecting to an online translation provider.
        /// In our implementation, however, this is not required, so we simply set
        /// this member to return always True.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;owner&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;translationProviderUri&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;translationProviderState&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;credentialStore&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        #region &quot;GetCredentialsFromUser&quot;
        public bool GetCredentialsFromUser(IWin32Window owner, Uri translationProviderUri, string translationProviderState, ITranslationProviderCredentialStore credentialStore)
        {            
            return true;
        }
        #endregion

        /// &lt;summary&gt;
        /// Used for displaying the plug-in info such as the plug-in name,
        /// tooltip, and icon.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;translationProviderUri&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;translationProviderState&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        #region &quot;GetDisplayInfo&quot;
        public TranslationProviderDisplayInfo GetDisplayInfo(Uri translationProviderUri, string translationProviderState)
        {
            TranslationProviderDisplayInfo info = new TranslationProviderDisplayInfo();
            info.Name = PluginResources.Plugin_NiceName;            
            info.TranslationProviderIcon = PluginResources.band_aid_icon;
            info.TooltipText = PluginResources.Plugin_Tooltip;

            info.SearchResultImage = PluginResources.band_aid_symbol;

            return info;
        }
        #endregion



        public bool SupportsTranslationProviderUri(Uri translationProviderUri)
        {
            if (translationProviderUri == null)
            {
                throw new ArgumentNullException(&quot;URI not supported by the plug-in.&quot;);
            }
            return String.Equals(translationProviderUri.Scheme, ListTranslationProvider.ListTranslationProviderScheme, StringComparison.CurrentCultureIgnoreCase);
        }

        public string TypeDescription
        {
            get { return PluginResources.Plugin_Description; }
        }

        public string TypeName
        {
            get { return PluginResources.Plugin_NiceName; }
        }

        #endregion
    }
}
</code></pre></section>
</div>
<h2 id="see-also">See Also</h2>
<p><a href="creating_the_translation_provider_ui_extension.html">Creating the Translation Provider UI Extension</a></p>
<p><a href="implementing_the_plugin_user_interface.html">Implementing the Plug-in User Interface</a></p>
<p><a href="the_resources_file.html">The Resources File</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/be0749b40ee64fbdad08417e8b3c0e7041444f51/apiconcepts/translationmemory/controlling_the_plugin_user_interface.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h4>On this page</h4>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
