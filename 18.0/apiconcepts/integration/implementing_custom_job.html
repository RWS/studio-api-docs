<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Implementing a custom job </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Implementing a custom job ">
    
    
      <link rel="shortcut icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>        

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="https://developers.rws.com/">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>

        <div class="container body-content">

          <div id="search-results">
            <div class="search-list">Search Results for <span></span></div>
            <div class="sr-items">
              <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
            </div>
            <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
          </div>
        </div>

      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="implementing-a-custom-job">Implementing a custom job</h1>

<p>The <code>IExternalJob</code> and <code>IExternalJobWithProgress</code> interfaces are the bridge that will allow you to inject custom code into the wizards as well as into Trados Studio's job mechanism. This gives you the advantage to achieve the same look and feel for long processing jobs besides helping you complete your work faster. Once you have an implementation ready all you need to do is publish  <code>ExecuteExternalJobEvent</code> using <code>IStudioEventAggregator</code>. As a result, Trados Studio will pick the job and execute it on a background thread or inject it into the previously-mentioned events. If the job is cancelled for any reason, you can handle that from the <code>JobCanceled</code> method.</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>IExternalJob</code></td>
<td>Implement this interface when you want to run a long processing job. The logic will be automatically executed on a background thread.</td>
</tr>
<tr>
<td><code>IExternalJobWithProgress</code></td>
<td>Implement this interface when you want to run a long processing job that can also report progress to the user. Triggering the <code>ProgressReported</code> event handler will allow you to report progress on the execution of your job to the user.</td>
</tr>
</tbody>
</table>
<p>Here is a code sample on how such an implementation should look like:</p>
<pre><code class="lang-cs">public class SampleJob : IExternalJobWithProgress
{
    public SampleJob()
    {
    }

    public string JobName { get; set; }
    
    public IDictionary&lt;string, object&gt; JobData { get; set; }

    public event EventHandler&lt;JobProgressArgs&gt; ProgressReported;

    public void JobCanceled(object sender, EventArgs e)
    {
        ProgressReported?.Invoke(this, new JobProgressArgs()
        {
            PercentComplete = 100,
            StatusMessage = &quot;Sample Job was cancelled&quot;
        });           
    }

    public void Execute(IExternalJobExecutionContext externalExecutionContext)
    {
        var packagelocation = JobData[PackagingConstants.ReturnPackageTargetPackageFilePath] as string;
        ProgressReported?.Invoke(this, new JobProgressArgs()
        {
            PercentComplete = 0,
            StatusMessage = &quot;Sample Job Started for package at location: &quot; + packagelocation
        });
        System.Threading.Thread.Sleep(1000);
        ProgressReported?.Invoke(this, new JobProgressArgs()
        {
            PercentComplete = 50,
            StatusMessage = &quot;Sample Job Processing for package at location: &quot; + packagelocation
        });
        System.Threading.Thread.Sleep(1000);
        ProgressReported?.Invoke(this, new JobProgressArgs()
        {
            PercentComplete = 100,
            StatusMessage = &quot;Sample Job Completed for package at location: &quot; + packagelocation
        });
    }
}
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>The <code>JobData</code> property acts as a bridge between Trados Studio and your plugin in case of using the job inside the <strong>Open Package</strong> and <strong>Create Return Package</strong> wizards. Trados Studio will set the file path on the property as follows:</p>
<ul>
<li>the file path to the project that was just imported into Trados Studio, in the case of the <strong>Open Package</strong> wizard</li>
<li>the file path for the created package, in the case of the <strong>Create Return Package</strong> wizard.
All constants used can be referenced from <a href="../../api/integration/Sdl.TranslationStudioAutomation.IntegrationApi.Packaging.PackagingConstants.html">PackagingConstants</a></li>
</ul>
</div>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/RWS/studio-api-docs/blob/docs/18.0/apiconcepts/integration/implementing_custom_job.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>